<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Optimize a function using a line search algorithm. — optim_LS • PopED</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Optimize a function using a line search algorithm. — optim_LS" />
<meta property="og:description" content="optim_LS performs sequential grid search optimization of an arbitrary function with respect 
to each of the parameters to be optimized over. 
The function works for both discrete and continuous optimization parameters 
and allows for box-constraints (by using the upper and lower function arguments) or sets of allowed values (by using the 
allowed_values function argument) for all parameters, or on a parameter per parameter basis." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PopED</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/intro-poped.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/examples.html">Examples</a>
    </li>
    <li>
      <a href="../articles/model_def_other_pkgs.html">Defining models for PopED using R based PKPD simulators</a>
    </li>
    <li>
      <a href="../articles/handling_LOQ.html">Optimal design with LOQ data in PopED</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewhooker/PopED">
    <span class="fab fa fab fa-github fa-lg"></span>
     
    Source
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimize a function using a line search algorithm.</h1>
    <small class="dont-index">Source: <a href='https://github.com/andrewhooker/PopED/blob/master/R/optim_LS.R'><code>R/optim_LS.R</code></a></small>
    <div class="hidden name"><code>optim_LS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>optim_LS</code> performs sequential grid search optimization of an arbitrary function with respect 
to each of the parameters to be optimized over. 
The function works for both discrete and continuous optimization parameters 
and allows for box-constraints (by using the upper and lower function arguments) or sets of allowed values (by using the 
allowed_values function argument) for all parameters, or on a parameter per parameter basis.</p>
    </div>

    <pre class="usage"><span class='fu'>optim_LS</span>(
  <span class='no'>par</span>,
  <span class='no'>fn</span>,
  <span class='kw'>lower</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>upper</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allowed_values</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>maximize</span> <span class='kw'>=</span> <span class='no'>F</span>,
  <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='no'>F</span>,
  <span class='kw'>parallel_type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>num_cores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mrgsolve_model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1e+07</span>)),
  <span class='kw'>replicates_index</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>par</span>)),
  <span class='kw'>ofv_initial</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>closed_bounds</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>par</th>
      <td><p>A vector of initial values for the parameters to be optimized over.</p></td>
    </tr>
    <tr>
      <th>fn</th>
      <td><p>A function to be minimized (or maximized), 
with first argument the vector of parameters over which minimization is to take place. 
It should return a scalar result.</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>Lower bounds on the parameters. A vector.</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>Upper bounds on the parameters. A vector.</p></td>
    </tr>
    <tr>
      <th>allowed_values</th>
      <td><p>A list containing allowed values for each parameter <code><a href='https://rdrr.io/r/base/list.html'>list(par1=c(2,3,4,5,6),par2=c(5,6,7,8))</a></code>. 
A vector containing allowed values for all parameters is also allowed <code><a href='https://rdrr.io/r/base/c.html'>c(2,3,4,5,6)</a></code>.</p></td>
    </tr>
    <tr>
      <th>line_length</th>
      <td><p>The number of different parameter values per parameter to evaluate.  The values are 
selected as an evenly spaced grid between the upper and lower bounds.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>Should the algorithm output results intermittently.</p></td>
    </tr>
    <tr>
      <th>maximize</th>
      <td><p>Should the function be maximized?  Default is to minimize.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Should we use parallel computations?</p></td>
    </tr>
    <tr>
      <th>parallel_type</th>
      <td><p>Which type of parallelization should be used? 
Can be "snow" or "multicore".  "snow"  works on Linux-like systems &amp; Windows. "multicore" works only on 
Linux-like systems.  By default this is chosen for you depending on your operating system. 
See <code><a href='start_parallel.html'>start_parallel</a></code>.</p></td>
    </tr>
    <tr>
      <th>num_cores</th>
      <td><p>The number of cores to use in the parallelization.  By default  is set to the number 
 output from 
<code><a href='https://rdrr.io/r/parallel/detectCores.html'>parallel::detectCores()</a></code>. 
See <code><a href='start_parallel.html'>start_parallel</a></code>.</p></td>
    </tr>
    <tr>
      <th>mrgsolve_model</th>
      <td><p>If the computations require a mrgsolve model and you
are using the "snow" method then you need to specify the name of the model
object created by <code>mread</code> or <code>mcode</code>.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>The random seed to use in the algorithm,</p></td>
    </tr>
    <tr>
      <th>replicates_index</th>
      <td><p>A vector, the same length as the parameters.
If two values are the same in this vector then the parameters may not assume the same value in the optimization.</p></td>
    </tr>
    <tr>
      <th>ofv_initial</th>
      <td><p>An initial objective function value (OFV).  If not NULL then the initial design is not evaluated
and the OFV value is assumed to be this number.</p></td>
    </tr>
    <tr>
      <th>closed_bounds</th>
      <td><p>Are the upper and lower limits open (boundaries not allowed) or closed (boundaries allowed) bounds?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code>fn</code> and <code>start_parallel</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>M. Foracchia, A.C. Hooker, P. Vicini and A. Ruggeri, "PopED, a software fir optimal 
experimental design in population kinetics", Computer Methods and Programs in Biomedicine, 74, 2004.</p></li>
<li><p>J. Nyberg, S. Ueckert, E.A. Stroemberg, S. Hennig, M.O. Karlsson and A.C. Hooker, "PopED: An extended, 
parallelized, nonlinear mixed effects models optimal design tool",  
Computer Methods and Programs in Biomedicine, 108, 2012.</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Optimize: 
<code><a href='Doptim.html'>Doptim</a>()</code>,
<code><a href='LEDoptim.html'>LEDoptim</a>()</code>,
<code><a href='RS_opt.html'>RS_opt</a>()</code>,
<code><a href='a_line_search.html'>a_line_search</a>()</code>,
<code><a href='bfgsb_min.html'>bfgsb_min</a>()</code>,
<code><a href='calc_autofocus.html'>calc_autofocus</a>()</code>,
<code><a href='calc_ofv_and_grad.html'>calc_ofv_and_grad</a>()</code>,
<code><a href='mfea.html'>mfea</a>()</code>,
<code><a href='optim_ARS.html'>optim_ARS</a>()</code>,
<code><a href='poped_optim_1.html'>poped_optim_1</a>()</code>,
<code><a href='poped_optim_2.html'>poped_optim_2</a>()</code>,
<code><a href='poped_optim_3.html'>poped_optim_3</a>()</code>,
<code><a href='poped_optimize.html'>poped_optimize</a>()</code>,
<code><a href='poped_optim.html'>poped_optim</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## "wild" function , global minimum at about -15.81515</span>
<span class='no'>fw</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fl'>10</span>*<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span>(<span class='fl'>0.3</span>*<span class='no'>x</span>)*<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span>(<span class='fl'>1.3</span>*<span class='no'>x</span>^<span class='fl'>2</span>) + <span class='fl'>0.00001</span>*<span class='no'>x</span>^<span class='fl'>4</span> + <span class='fl'>0.2</span>*<span class='no'>x</span>+<span class='fl'>80</span>

<span class='co'># optimization with fewer function evaluations compared to SANN</span>
<span class='no'>res1</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>50</span>, <span class='no'>fw</span>,<span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>50</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>10000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 50 
#&gt;    Initial OFV: 159.0012 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 50 to -15.8166 ; OFV = 67.485 
#&gt; 
#&gt;    Elapsed time: 0.032 seconds.
#&gt; 
#&gt;    Final OFV =  67.48502 
#&gt;    Parameters: -15.81658 
#&gt; </div><div class='input'>
<span class='co'># Upper and lower bounds should be considered carefully</span>
<span class='no'>res2</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>50</span>, <span class='no'>fw</span>, <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>Inf</span>,<span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>Inf</span>,<span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>10000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 50 
#&gt;    Initial OFV: 159.0012 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 50 to -5.0055 ; OFV = 69.8766 
#&gt; 
#&gt;    Elapsed time: 0.053 seconds.
#&gt; 
#&gt;    Final OFV =  69.87659 
#&gt;    Parameters: -5.005501 
#&gt; </div><div class='input'>
<span class='co'># Only integer values allowed</span>
<span class='no'>res_int</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>50</span>, <span class='no'>fw</span>, <span class='kw'>allowed_values</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>1</span>))</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 50 
#&gt;    Initial OFV: 159.0012 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 50 to -17 ; OFV = 68.5368 
#&gt; 
#&gt;    Elapsed time: 0.001 seconds.
#&gt; 
#&gt;    Final OFV =  68.53679 
#&gt;    Parameters: -17 
#&gt; </div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='co'>#plot of the function and solutions</span>
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>graphics</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='no'>fw</span>, -<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Minimizing 'wild function'"</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(-<span class='fl'>15.81515</span>, <span class='fu'>fw</span>(-<span class='fl'>15.81515</span>), <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>res1</span>$<span class='no'>par</span>, <span class='no'>res1</span>$<span class='no'>ofv</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>res_int</span>$<span class='no'>par</span>, <span class='no'>res_int</span>$<span class='no'>ofv</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1</span>)
}

<span class='co'># Rosenbrock Banana function</span>
<span class='co'># f(x, y) = (a-x)^2 + b*(y-x^2)^2</span>
<span class='co'># global minimum at (x, y)=(a, a^2), where f(x, y)=0. </span>
<span class='co'># Usually a = 1 and b = 100 so x=1 and y=1</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>fr</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>a</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='no'>b</span><span class='kw'>=</span><span class='fl'>100</span>) {
    <span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>[<span class='fl'>1</span>]
    <span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>[<span class='fl'>2</span>]
    <span class='no'>b</span>*(<span class='no'>x2</span> - <span class='no'>x1</span>*<span class='no'>x1</span>)^<span class='fl'>2</span> + (<span class='no'>a</span> - <span class='no'>x1</span>)^<span class='fl'>2</span>
  }

  <span class='no'>res3</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1.2</span>,<span class='fl'>1</span>), <span class='no'>fr</span>,<span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>5</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

  <span class='co'># plot the surface</span>
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='kw'>length</span><span class='kw'>=</span> <span class='fl'>30</span>)
  <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>
  <span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>y</span>){<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>x</span>,<span class='no'>y</span>),<span class='fl'>1</span>,<span class='no'>fr</span>)}
  <span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>f</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/persp.html'>persp</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>z</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>expand</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"lightblue"</span>, <span class='kw'>ticktype</span><span class='kw'>=</span><span class='st'>"detailed"</span>) <span class='kw'>-&gt;</span> <span class='no'>res</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/trans3d.html'>trans3d</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='kw'>pmat</span> <span class='kw'>=</span> <span class='no'>res</span>), <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>,<span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>2</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/trans3d.html'>trans3d</a></span>(<span class='no'>res3</span>$<span class='no'>par</span>[<span class='fl'>1</span>], <span class='no'>res3</span>$<span class='no'>par</span>[<span class='fl'>1</span>], <span class='no'>res3</span>$<span class='no'>ofv</span>, <span class='kw'>pmat</span> <span class='kw'>=</span> <span class='no'>res</span>), <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>,<span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>2</span>)
}

<span class='co'># box constraints</span>
<span class='no'>flb</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>){
  <span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>x</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>4</span>, <span class='no'>p</span>-<span class='fl'>1</span>)) * (<span class='no'>x</span> - <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='no'>x</span>[-<span class='no'>p</span>])^<span class='fl'>2</span>)^<span class='fl'>2</span>)
}

<span class='co'>## 25-dimensional box constrained</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/stats/optim.html'>optim</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>, <span class='fl'>25</span>), <span class='no'>flb</span>,<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>25</span>), <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>4</span>, <span class='fl'>25</span>),<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"L-BFGS-B"</span>)
}
<span class='no'>res_box</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>, <span class='fl'>25</span>), <span class='no'>flb</span>,<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>25</span>), <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>4</span>, <span class='fl'>25</span>),<span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 
#&gt;    Initial OFV: 3460 
#&gt; 
#&gt;    Searching parameter 7 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3370.22 
#&gt;    Searching parameter 16 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3280.43 
#&gt;    Searching parameter 2 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3190.65 
#&gt;    Searching parameter 25 
#&gt;      Changed from 3 to 4 ; OFV = 3146.65 
#&gt;    Searching parameter 20 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3056.87 
#&gt;    Searching parameter 11 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2967.09 
#&gt;    Searching parameter 1 
#&gt;      Changed from 3 to 2 ; OFV = 2789.85 
#&gt;    Searching parameter 13 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2700.07 
#&gt;    Searching parameter 18 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2610.29 
#&gt;    Searching parameter 9 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2520.5 
#&gt;    Searching parameter 21 
#&gt;      Changed from 3 to 2 ; OFV = 2397.28 
#&gt;    Searching parameter 4 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2307.5 
#&gt;    Searching parameter 5 
#&gt;      Changed from 3 to 2 ; OFV = 2184.28 
#&gt;    Searching parameter 8 
#&gt;      Changed from 3 to 2 ; OFV = 2026.82 
#&gt;    Searching parameter 12 
#&gt;      Changed from 3 to 2 ; OFV = 1869.37 
#&gt;    Searching parameter 19 
#&gt;      Changed from 3 to 2 ; OFV = 1711.91 
#&gt;    Searching parameter 15 
#&gt;      Changed from 3 to 2 ; OFV = 1589.68 
#&gt;    Searching parameter 10 
#&gt;      Changed from 3 to 2 ; OFV = 1432.22 
#&gt;    Searching parameter 22 
#&gt;      Changed from 3 to 2 ; OFV = 1304.22 
#&gt;    Searching parameter 3 
#&gt;      Changed from 3 to 2 ; OFV = 1146.77 
#&gt;    Searching parameter 6 
#&gt;      Changed from 3 to 2 ; OFV = 984.533 
#&gt;    Searching parameter 17 
#&gt;      Changed from 3 to 2 ; OFV = 827.077 
#&gt;    Searching parameter 23 
#&gt;      Changed from 3 to 2 ; OFV = 699.077 
#&gt;    Searching parameter 24 
#&gt;      Changed from 3 to 2.10811 ; OFV = 610.183 
#&gt;    Searching parameter 14 
#&gt;      Changed from 3 to 2 ; OFV = 446.962 
#&gt; 
#&gt;    Elapsed time: 0.15 seconds.
#&gt; 
#&gt;    Final OFV =  446.9622 
#&gt;    Parameters: 2 2.144144 2 2.144144 2 2 2.144144 2 2.144144 2 2.144144 2 2.144144 2 2 2.144144 2 2.144144 2 2.144144 2 2 2 2.108108 4 
#&gt; </div><div class='input'>
<span class='co'># one-dimensional function</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>)  <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>x</span>)+<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='no'>x</span>)
  <span class='no'>res5</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(-<span class='fl'>20</span>,<span class='no'>f</span>,<span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>20</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>500</span>)

  <span class='fu'><a href='https://rdrr.io/r/graphics/curve.html'>curve</a></span>(<span class='no'>f</span>, -<span class='fl'>20</span>, <span class='fl'>20</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>res5</span>$<span class='no'>par</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>4</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>"green"</span>)
}

<span class='co'># one-dimensional function</span>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>)  (<span class='no'>x</span>^<span class='fl'>2</span>+<span class='no'>x</span>)*<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='no'>x</span>) <span class='co'># -10 &lt; x &lt; 10</span>
<span class='no'>res_max</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>0</span>,<span class='no'>f</span>,<span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>10</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>maximize</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 0 
#&gt;    Initial OFV: 0 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 0 to 6.55656 ; OFV = 47.7052 
#&gt; 
#&gt;    Elapsed time: 0.003 seconds.
#&gt; 
#&gt;    Final OFV =  47.7052 
#&gt;    Parameters: 6.556557 
#&gt; </div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>res_min</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>0</span>,<span class='no'>f</span>,<span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>10</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

  <span class='fu'><a href='https://rdrr.io/r/graphics/curve.html'>curve</a></span>(<span class='no'>f</span>, -<span class='fl'>10</span>, <span class='fl'>10</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>res_min</span>$<span class='no'>par</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>4</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>"green"</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>res_max</span>$<span class='no'>par</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>4</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>)
}


<span class='co'># two-dimensional Rastrigin function</span>
<span class='co'>#It has a global minimum at f(x) = f(0) = 0.</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>Rastrigin</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x1</span>, <span class='no'>x2</span>){
    <span class='fl'>20</span> + <span class='no'>x1</span>^<span class='fl'>2</span> + <span class='no'>x2</span>^<span class='fl'>2</span> - <span class='fl'>10</span>*(<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='fl'>2</span>*<span class='no'>pi</span>*<span class='no'>x1</span>) + <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='fl'>2</span>*<span class='no'>pi</span>*<span class='no'>x2</span>))
  }


  <span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>5.12</span>, <span class='fl'>5.12</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)
  <span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>Rastrigin</span>)

  <span class='no'>res6</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>),<span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>Rastrigin</span>(<span class='no'>x</span>[<span class='fl'>1</span>], <span class='no'>x</span>[<span class='fl'>2</span>]),
                   <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>5.12</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>5.12</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

  <span class='co'># color scale</span>
  <span class='no'>nrz</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>z</span>)
  <span class='no'>ncz</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>z</span>)
  <span class='no'>jet.colors</span> <span class='kw'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"#00007F"</span>, <span class='st'>"blue"</span>, <span class='st'>"#007FFF"</span>, <span class='st'>"cyan"</span>,
                       <span class='st'>"#7FFF7F"</span>, <span class='st'>"yellow"</span>, <span class='st'>"#FF7F00"</span>, <span class='st'>"red"</span>, <span class='st'>"#7F0000"</span>))
  <span class='co'># Generate the desired number of colors from this palette</span>
  <span class='no'>nbcol</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
  <span class='no'>color</span> <span class='kw'>&lt;-</span> <span class='fu'>jet.colors</span>(<span class='no'>nbcol</span>)
  <span class='co'># Compute the z-value at the facet centres</span>
  <span class='no'>zfacet</span> <span class='kw'>&lt;-</span> <span class='no'>z</span>[-<span class='fl'>1</span>, -<span class='fl'>1</span>] + <span class='no'>z</span>[-<span class='fl'>1</span>, -<span class='no'>ncz</span>] + <span class='no'>z</span>[-<span class='no'>nrz</span>, -<span class='fl'>1</span>] + <span class='no'>z</span>[-<span class='no'>nrz</span>, -<span class='no'>ncz</span>]
  <span class='co'># Recode facet z-values into color indices</span>
  <span class='no'>facetcol</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='no'>zfacet</span>, <span class='no'>nbcol</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/persp.html'>persp</a></span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>z</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>color</span>[<span class='no'>facetcol</span>], <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>30</span>)
  <span class='fu'><a href='https://rdrr.io/r/graphics/filled.contour.html'>filled.contour</a></span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>z</span>, <span class='kw'>color.palette</span> <span class='kw'>=</span> <span class='no'>jet.colors</span>)
}


<span class='co'>## Parallel computation  </span>
<span class='co'>## works better when each evaluation takes longer</span>
<span class='co'>## here we have added extra time to the computations</span>
<span class='co'>## just to show that it works</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>res7</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>),<span class='kw'>function</span>(<span class='no'>x</span>){<span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span>(<span class='fl'>0.01</span>); <span class='fu'>Rastrigin</span>(<span class='no'>x</span>[<span class='fl'>1</span>], <span class='no'>x</span>[<span class='fl'>2</span>])},
                   <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>5.12</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>5.12</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>200</span>)
  <span class='no'>res8</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>),<span class='kw'>function</span>(<span class='no'>x</span>){<span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span>(<span class='fl'>0.01</span>); <span class='fu'>Rastrigin</span>(<span class='no'>x</span>[<span class='fl'>1</span>], <span class='no'>x</span>[<span class='fl'>2</span>])},
                   <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>5.12</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>5.12</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='no'>res9</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>),<span class='kw'>function</span>(<span class='no'>x</span>){<span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span>(<span class='fl'>0.01</span>); <span class='fu'>Rastrigin</span>(<span class='no'>x</span>[<span class='fl'>1</span>], <span class='no'>x</span>[<span class='fl'>2</span>])},
                   <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>5.12</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>5.12</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                   <span class='kw'>parallel_type</span> <span class='kw'>=</span> <span class='st'>"snow"</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://katalog.uu.se/profile/?id=N4-631'>Andrew C. Hooker</a>, Marco Foracchia, <a href='https://katalog.uu.se/profile/?id=N9-467'>Sebastian Ueckert</a>, <a href='https://scholar.google.se/citations?user=4CgHwr0AAAAJ&hl=en'>Joakim Nyberg</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


