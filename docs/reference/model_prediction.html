<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Model predictions — model_prediction • PopED</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Model predictions — model_prediction" />
<meta property="og:description" content="Function generates a data frame of model predictions for the typical value in the population,
individual predictions and data predictions.  The function can also be used to generate datasets
without predictions using the design specified in the arguments." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PopED</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/intro-poped.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/examples.html">Examples</a>
    </li>
    <li>
      <a href="../articles/model_def_other_pkgs.html">Defining models for PopED using R based PKPD simulators</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewhooker/PopED">
    <span class="fab fa fab fa-github fa-lg"></span>
     
    Source
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model predictions</h1>
    <small class="dont-index">Source: <a href='https://github.com/andrewhooker/PopED/blob/master/R/model_prediction.R'><code>R/model_prediction.R</code></a></small>
    <div class="hidden name"><code>model_prediction.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function generates a data frame of model predictions for the typical value in the population,
individual predictions and data predictions.  The function can also be used to generate datasets
without predictions using the design specified in the arguments.</p>
    </div>

    <pre class="usage"><span class='fu'>model_prediction</span>(
  <span class='kw'>poped.db</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>design</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>xt</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span><span class='kw'>[[</span><span class='st'>"xt"</span>]], <span class='kw'>groupsize</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>groupsize</span>, <span class='kw'>m</span>
    <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span><span class='kw'>[[</span><span class='st'>"m"</span>]], <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span><span class='kw'>[[</span><span class='st'>"x"</span>]], <span class='kw'>a</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span><span class='kw'>[[</span><span class='st'>"a"</span>]], <span class='kw'>ni</span>
    <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>ni</span>, <span class='kw'>model_switch</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>model_switch</span>),
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>fg_pointer</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>model</span>$<span class='no'>fg_pointer</span>, <span class='kw'>ff_pointer</span> <span class='kw'>=</span>
    <span class='no'>poped.db</span>$<span class='no'>model</span>$<span class='no'>ff_pointer</span>, <span class='kw'>ferror_pointer</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>model</span>$<span class='no'>ferror_pointer</span>),
  <span class='kw'>parameters</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>docc</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>docc</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>d</span>, <span class='kw'>bpop</span> <span class='kw'>=</span>
    <span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>bpop</span>, <span class='kw'>covd</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>covd</span>, <span class='kw'>covdocc</span> <span class='kw'>=</span>
    <span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>covdocc</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>sigma</span>),
  <span class='kw'>IPRED</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>DV</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>dosing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>predictions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>filename</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>models_to_use</span> <span class='kw'>=</span> <span class='st'>"all"</span>,
  <span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>model_minxt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>model_maxxt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>include_sample_times</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>groups_to_use</span> <span class='kw'>=</span> <span class='st'>"all"</span>,
  <span class='kw'>include_a</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>include_x</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>manipulation</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>PI</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>PI_conf_level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>poped.db</th>
      <td><p>A PopED database created by <code><a href='create.poped.database.html'>create.poped.database</a></code>.</p></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>A list that is passed as arguments to the function <code><a href='create_design.html'>create_design</a></code> to create a design object.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>A list containing the model elements to use for the predictions</p></td>
    </tr>
    <tr>
      <th>parameters</th>
      <td><p>A list of parameters to use in the model predictions.</p></td>
    </tr>
    <tr>
      <th>IPRED</th>
      <td><p>Should we simulate individual predictions?</p></td>
    </tr>
    <tr>
      <th>DV</th>
      <td><p>should we simulate observations?</p></td>
    </tr>
    <tr>
      <th>dosing</th>
      <td><p>A list of lists that adds dosing records to the data frame (Each inner list corresponding to a group in the design).</p></td>
    </tr>
    <tr>
      <th>predictions</th>
      <td><p>Should the resulting data frame have predictions?  Either <code>TRUE</code> or <code>FALSE</code> 
or <code>NULL</code> in which case the function decides based on other arguments.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>A filename that the data frame should be written to in comma separate value (csv) format.</p></td>
    </tr>
    <tr>
      <th>models_to_use</th>
      <td><p>Which model numbers should we use? 
Model numbers are defined in <code>design</code> below using <code>model_switch</code>. For an explanation see <code><a href='create_design.html'>create_design</a></code>.</p></td>
    </tr>
    <tr>
      <th>model_num_points</th>
      <td><p>How many extra observation rows should be created in the data frame for each group or individual 
per model.  If used then the points are placed evenly between <code>model_minxt</code> and <code>model_maxxt</code>. This option
is used by <code><a href='plot_model_prediction.html'>plot_model_prediction</a></code> to simulate the response of the model on a finer grid then the defined design.
If <code>NULL</code> then only the input design is used.  Can be a single value or a vector the same length as the number of models.</p></td>
    </tr>
    <tr>
      <th>model_minxt</th>
      <td><p>The minimum time value for extra observation rows indicated by <code>model_num_points</code>. 
A vector the same length as the number of models</p></td>
    </tr>
    <tr>
      <th>model_maxxt</th>
      <td><p>The minimum time value for extra observation rows indicated by <code>model_num_points</code>. 
A vector the same length as the number of models</p></td>
    </tr>
    <tr>
      <th>include_sample_times</th>
      <td><p>Should observations rows in the output data frame include the times indicated in the input design?</p></td>
    </tr>
    <tr>
      <th>groups_to_use</th>
      <td><p>Which groups should we include in the output data frame?Allowed values are <code>"all"</code> or 
a vector of numbers indicating the groups to include, e.g. <code><a href='https://rdrr.io/r/base/c.html'>c(1,3,6)</a></code>.</p></td>
    </tr>
    <tr>
      <th>include_a</th>
      <td><p>Should we include the continuous design variables in the output?</p></td>
    </tr>
    <tr>
      <th>include_x</th>
      <td><p>Should we include the discrete design variables in the output?</p></td>
    </tr>
    <tr>
      <th>manipulation</th>
      <td><p>A list of one or more <code><a href='https://rdrr.io/r/base/expression.html'>expression</a></code> arguments.  Each expression is 
evaluated using the code <code>for(i in 1:length(manipulation)){df &lt;- within(df,{eval(manipulation[[i]])})}</code>. 
Can be used to transform 
or create new columns in the resulting data frame. Note that these transformations are created after any model predictions occur,
so transformations in colums having to do with input to model predictions  will not affect the predictions.</p></td>
    </tr>
    <tr>
      <th>PI</th>
      <td><p>Compute prediction intervals for the data given the model.  Predictions are based on first-order approximations to 
the model variance and a normality assumption of that variance.</p></td>
    </tr>
    <tr>
      <th>PI_conf_level</th>
      <td><p>The confidence level for the prediction interval computed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dataframe containing a design and (potentially) simulated data with some dense grid of samples and/or 
based on the input design.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other evaluate_design: 
<code><a href='evaluate.fim.html'>evaluate.fim</a>()</code>,
<code><a href='evaluate_design.html'>evaluate_design</a>()</code>,
<code><a href='evaluate_power.html'>evaluate_power</a>()</code>,
<code><a href='get_rse.html'>get_rse</a>()</code>,
<code><a href='plot_efficiency_of_windows.html'>plot_efficiency_of_windows</a>()</code>,
<code><a href='plot_model_prediction.html'>plot_model_prediction</a>()</code></p>
<p>Other Simulation: 
<code><a href='plot_efficiency_of_windows.html'>plot_efficiency_of_windows</a>()</code>,
<code><a href='plot_model_prediction.html'>plot_model_prediction</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Warfarin example from software comparison in:</span>
<span class='co'>## Nyberg et al., "Methods and software tools for design evaluation </span>
<span class='co'>##   for population pharmacokinetics-pharmacodynamics studies", </span>
<span class='co'>##   Br. J. Clin. Pharm., 2014. </span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>PopED</span>)

<span class='co'>## find the parameters that are needed to define from the structural model</span>
<span class='no'>ff.PK.1.comp.oral.md.CL</span></div><div class='output co'>#&gt; function (model_switch, xt, parameters, poped.db) 
#&gt; {
#&gt;     with(as.list(parameters), {
#&gt;         y = xt
#&gt;         N = floor(xt/TAU) + 1
#&gt;         y = (DOSE * Favail/V) * (KA/(KA - CL/V)) * (exp(-CL/V * 
#&gt;             (xt - (N - 1) * TAU)) * (1 - exp(-N * CL/V * TAU))/(1 - 
#&gt;             exp(-CL/V * TAU)) - exp(-KA * (xt - (N - 1) * TAU)) * 
#&gt;             (1 - exp(-N * KA * TAU))/(1 - exp(-KA * TAU)))
#&gt;         return(list(y = y, poped.db = poped.db))
#&gt;     })
#&gt; }
#&gt; &lt;bytecode: 0x7ffbc1bcdeb0&gt;
#&gt; &lt;environment: namespace:PopED&gt;</div><div class='input'>
<span class='co'>## -- parameter definition function </span>
<span class='co'>## -- names match parameters in function ff</span>
<span class='no'>sfg</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>a</span>,<span class='no'>bpop</span>,<span class='no'>b</span>,<span class='no'>bocc</span>){
  <span class='no'>parameters</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>1</span>]*<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>b</span>[<span class='fl'>1</span>]),
               <span class='kw'>V</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>2</span>]*<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>b</span>[<span class='fl'>2</span>]),
               <span class='kw'>KA</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>3</span>]*<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>b</span>[<span class='fl'>3</span>]),
               <span class='kw'>Favail</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>4</span>],
               <span class='kw'>DOSE</span><span class='kw'>=</span><span class='no'>a</span>[<span class='fl'>1</span>])
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>parameters</span>)
}

<span class='co'>## -- Define initial design  and design space</span>
<span class='no'>poped.db</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create.poped.database.html'>create.poped.database</a></span>(<span class='kw'>ff_fun</span><span class='kw'>=</span><span class='no'>ff.PK.1.comp.oral.sd.CL</span>,
                                  <span class='kw'>fg_fun</span><span class='kw'>=</span><span class='no'>sfg</span>,
                                  <span class='kw'>fError_fun</span><span class='kw'>=</span><span class='no'>feps.prop</span>,
                                  <span class='kw'>bpop</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.15</span>, <span class='kw'>V</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>KA</span><span class='kw'>=</span><span class='fl'>1.0</span>, <span class='kw'>Favail</span><span class='kw'>=</span><span class='fl'>1</span>),
                                  <span class='kw'>notfixed_bpop</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),
                                  <span class='kw'>d</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.07</span>, <span class='kw'>V</span><span class='kw'>=</span><span class='fl'>0.02</span>, <span class='kw'>KA</span><span class='kw'>=</span><span class='fl'>0.6</span>),
                                  <span class='kw'>sigma</span><span class='kw'>=</span><span class='fl'>0.01</span>,
                                  <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fl'>32</span>,
                                  <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
                                  <span class='kw'>minxt</span><span class='kw'>=</span><span class='fl'>0</span>,
                                  <span class='kw'>maxxt</span><span class='kw'>=</span><span class='fl'>120</span>,
                                  <span class='kw'>a</span><span class='kw'>=</span><span class='fl'>70</span>)

<span class='co'>## data frame with model predictions</span>
<span class='no'>df_1</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='no'>poped.db</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_1</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    Time      PRED Group Model a_i
#&gt; 1   0.5 3.4254357     1     1  70
#&gt; 2   1.0 5.4711041     1     1  70
#&gt; 3   2.0 7.3821834     1     1  70
#&gt; 4   6.0 7.9462805     1     1  70
#&gt; 5  24.0 5.6858561     1     1  70
#&gt; 6  36.0 4.5402483     1     1  70
#&gt; 7  72.0 2.3116966     1     1  70
#&gt; 8 120.0 0.9398657     1     1  70</div><div class='input'>
<span class='co'>##  data frame with variability </span>
<span class='no'>df_2</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='no'>poped.db</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_2</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    ID  Time         DV    IPRED      PRED Group Model a_i
#&gt; 1   1   0.5  2.3800236 2.352885 3.4254357     1     1  70
#&gt; 2   1   1.0  4.2029869 4.167358 5.4711041     1     1  70
#&gt; 3   1   2.0  6.0250484 6.628460 7.3821834     1     1  70
#&gt; 4   1   6.0 10.6003247 9.428073 7.9462805     1     1  70
#&gt; 5   1  24.0  7.3829039 7.111946 5.6858561     1     1  70
#&gt; 6   1  36.0  5.1180355 5.665993 4.5402483     1     1  70
#&gt; 7   1  72.0  2.6919875 2.865000 2.3116966     1     1  70
#&gt; 8   1 120.0  1.1947993 1.154134 0.9398657     1     1  70
#&gt; 9   2   0.5  2.5705709 2.416020 3.4254357     1     1  70
#&gt; 10  2   1.0  4.7509404 4.166896 5.4711041     1     1  70
#&gt; 11  2   2.0  5.7171194 6.334689 7.3821834     1     1  70
#&gt; 12  2   6.0  7.6625930 8.183819 7.9462805     1     1  70
#&gt; 13  2  24.0  6.5161958 6.013418 5.6858561     1     1  70
#&gt; 14  2  36.0  4.9060740 4.806975 4.5402483     1     1  70
#&gt; 15  2  72.0  2.4332146 2.455401 2.3116966     1     1  70
#&gt; 16  2 120.0  0.9933456 1.002590 0.9398657     1     1  70
#&gt; 17  3   0.5  5.4419156 5.831451 3.4254357     1     1  70
#&gt; 18  3   1.0  8.0770953 8.064518 5.4711041     1     1  70
#&gt; 19  3   2.0 10.1800510 9.125600 7.3821834     1     1  70
#&gt; 20  3   6.0  8.6966384 8.472325 7.9462805     1     1  70</div><div class='input'>
<span class='co'>## data frame with variability (only IPRED, no DV)</span>
<span class='no'>df_3</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='no'>poped.db</span>,<span class='kw'>IPRED</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_3</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    ID  Time    IPRED      PRED Group Model a_i
#&gt; 1   1   0.5 1.331747 3.4254357     1     1  70
#&gt; 2   1   1.0 2.425106 5.4711041     1     1  70
#&gt; 3   1   2.0 4.053278 7.3821834     1     1  70
#&gt; 4   1   6.0 6.564106 7.9462805     1     1  70
#&gt; 5   1  24.0 5.606070 5.6858561     1     1  70
#&gt; 6   1  36.0 4.652204 4.5402483     1     1  70
#&gt; 7   1  72.0 2.657258 2.3116966     1     1  70
#&gt; 8   1 120.0 1.259309 0.9398657     1     1  70
#&gt; 9   2   0.5 5.041980 3.4254357     1     1  70
#&gt; 10  2   1.0 7.300742 5.4711041     1     1  70
#&gt; 11  2   2.0 8.723086 7.3821834     1     1  70
#&gt; 12  2   6.0 8.731333 7.9462805     1     1  70
#&gt; 13  2  24.0 7.192552 5.6858561     1     1  70
#&gt; 14  2  36.0 6.320159 4.5402483     1     1  70
#&gt; 15  2  72.0 4.288082 2.3116966     1     1  70
#&gt; 16  2 120.0 2.556484 0.9398657     1     1  70
#&gt; 17  3   0.5 1.373968 3.4254357     1     1  70
#&gt; 18  3   1.0 2.497014 5.4711041     1     1  70
#&gt; 19  3   2.0 4.156027 7.3821834     1     1  70
#&gt; 20  3   6.0 6.602481 7.9462805     1     1  70</div><div class='input'>
<span class='co'>## data frame with model predictions, no continuous design variables in data frame</span>
<span class='no'>df_4</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='no'>poped.db</span>,<span class='kw'>include_a</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_4</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    Time      PRED Group Model
#&gt; 1   0.5 3.4254357     1     1
#&gt; 2   1.0 5.4711041     1     1
#&gt; 3   2.0 7.3821834     1     1
#&gt; 4   6.0 7.9462805     1     1
#&gt; 5  24.0 5.6858561     1     1
#&gt; 6  36.0 4.5402483     1     1
#&gt; 7  72.0 2.3116966     1     1
#&gt; 8 120.0 0.9398657     1     1</div><div class='input'>
<span class='co'>## -- 2 groups</span>
<span class='no'>poped.db.2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create.poped.database.html'>create.poped.database</a></span>(<span class='kw'>ff_fun</span><span class='kw'>=</span><span class='no'>ff.PK.1.comp.oral.sd.CL</span>,
                                    <span class='kw'>fg_fun</span><span class='kw'>=</span><span class='no'>sfg</span>,
                                    <span class='kw'>fError_fun</span><span class='kw'>=</span><span class='no'>feps.prop</span>,
                                    <span class='kw'>bpop</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.15</span>, <span class='kw'>V</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>KA</span><span class='kw'>=</span><span class='fl'>1.0</span>, <span class='kw'>Favail</span><span class='kw'>=</span><span class='fl'>1</span>),
                                    <span class='kw'>notfixed_bpop</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),
                                    <span class='kw'>d</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.07</span>, <span class='kw'>V</span><span class='kw'>=</span><span class='fl'>0.02</span>, <span class='kw'>KA</span><span class='kw'>=</span><span class='fl'>0.6</span>),
                                    <span class='kw'>sigma</span><span class='kw'>=</span><span class='fl'>0.01</span>,
                                    <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fl'>3</span>,<span class='fl'>3</span>),
                                    <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>2</span>,
                                    <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
                                    <span class='kw'>minxt</span><span class='kw'>=</span><span class='fl'>0</span>,
                                    <span class='kw'>maxxt</span><span class='kw'>=</span><span class='fl'>120</span>,
                                    <span class='kw'>a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fl'>70</span>,<span class='fl'>50</span>))

<span class='no'>df_5</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='no'>poped.db.2</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_5</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    ID  Time        DV     IPRED      PRED Group Model a_i
#&gt; 1   1   0.5 1.8824573 2.6986425 3.4254357     1     1  70
#&gt; 2   1   1.0 4.4606407 4.5224462 5.4711041     1     1  70
#&gt; 3   1   2.0 6.1021726 6.5605583 7.3821834     1     1  70
#&gt; 4   1   6.0 8.0079320 7.7839864 7.9462805     1     1  70
#&gt; 5   1  24.0 5.9242971 5.5574735 5.6858561     1     1  70
#&gt; 6   1  36.0 4.1273096 4.4035807 4.5402483     1     1  70
#&gt; 7   1  72.0 2.2569618 2.1907440 2.3116966     1     1  70
#&gt; 8   1 120.0 0.7775830 0.8635865 0.9398657     1     1  70
#&gt; 9   2   0.5 1.3147314 1.2950745 3.4254357     1     1  70
#&gt; 10  2   1.0 2.3422395 2.3370827 5.4711041     1     1  70
#&gt; 11  2   2.0 3.9529858 3.8424651 7.3821834     1     1  70
#&gt; 12  2   6.0 6.6757835 5.9423279 7.9462805     1     1  70
#&gt; 13  2  24.0 6.2962206 4.7862925 5.6858561     1     1  70
#&gt; 14  2  36.0 3.9901656 3.8830024 4.5402483     1     1  70
#&gt; 15  2  72.0 1.9881554 2.0728924 2.3116966     1     1  70
#&gt; 16  2 120.0 0.8062582 0.8976806 0.9398657     1     1  70
#&gt; 17  3   0.5 2.6556066 2.6104406 3.4254357     1     1  70
#&gt; 18  3   1.0 4.9511436 4.5376033 5.4711041     1     1  70
#&gt; 19  3   2.0 5.9386580 6.9882512 7.3821834     1     1  70
#&gt; 20  3   6.0 9.0706361 9.2475260 7.9462805     1     1  70</div><div class='input'>
<span class='co'>## without a poped database, just describing the design</span>
<span class='co'>## Useful for creating datasets for use in other software (like NONMEM)</span>
<span class='no'>design_1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
  <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
  <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>2</span>,
  <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fl'>3</span>)

<span class='no'>design_2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
  <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
  <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>2</span>,
  <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fl'>3</span>,
  <span class='kw'>a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>WT</span><span class='kw'>=</span><span class='fl'>70</span>,<span class='kw'>AGE</span><span class='kw'>=</span><span class='fl'>50</span>))

<span class='no'>design_3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
  <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
  <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>2</span>,
  <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fl'>3</span>,
  <span class='kw'>a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>WT</span><span class='kw'>=</span><span class='fl'>70</span>,<span class='kw'>AGE</span><span class='kw'>=</span><span class='fl'>50</span>),<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>AGE</span><span class='kw'>=</span><span class='fl'>45</span>,<span class='kw'>WT</span><span class='kw'>=</span><span class='fl'>60</span>)))

(<span class='no'>df_6</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_1</span>))</div><div class='output co'>#&gt;     Time PRED Group Model
#&gt; 1    0.5   NA     1     1
#&gt; 2    1.0   NA     1     1
#&gt; 3    2.0   NA     1     1
#&gt; 4    6.0   NA     1     1
#&gt; 5   24.0   NA     1     1
#&gt; 6   36.0   NA     1     1
#&gt; 7   72.0   NA     1     1
#&gt; 8  120.0   NA     1     1
#&gt; 9    0.5   NA     2     1
#&gt; 10   1.0   NA     2     1
#&gt; 11   2.0   NA     2     1
#&gt; 12   6.0   NA     2     1
#&gt; 13  24.0   NA     2     1
#&gt; 14  36.0   NA     2     1
#&gt; 15  72.0   NA     2     1
#&gt; 16 120.0   NA     2     1</div><div class='input'>(<span class='no'>df_7</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_2</span>))</div><div class='output co'>#&gt;     Time PRED Group Model WT AGE
#&gt; 1    0.5   NA     1     1 70  50
#&gt; 2    1.0   NA     1     1 70  50
#&gt; 3    2.0   NA     1     1 70  50
#&gt; 4    6.0   NA     1     1 70  50
#&gt; 5   24.0   NA     1     1 70  50
#&gt; 6   36.0   NA     1     1 70  50
#&gt; 7   72.0   NA     1     1 70  50
#&gt; 8  120.0   NA     1     1 70  50
#&gt; 9    0.5   NA     2     1 70  50
#&gt; 10   1.0   NA     2     1 70  50
#&gt; 11   2.0   NA     2     1 70  50
#&gt; 12   6.0   NA     2     1 70  50
#&gt; 13  24.0   NA     2     1 70  50
#&gt; 14  36.0   NA     2     1 70  50
#&gt; 15  72.0   NA     2     1 70  50
#&gt; 16 120.0   NA     2     1 70  50</div><div class='input'>(<span class='no'>df_8</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>))</div><div class='output co'>#&gt;     Time PRED Group Model WT AGE
#&gt; 1    0.5   NA     1     1 70  50
#&gt; 2    1.0   NA     1     1 70  50
#&gt; 3    2.0   NA     1     1 70  50
#&gt; 4    6.0   NA     1     1 70  50
#&gt; 5   24.0   NA     1     1 70  50
#&gt; 6   36.0   NA     1     1 70  50
#&gt; 7   72.0   NA     1     1 70  50
#&gt; 8  120.0   NA     1     1 70  50
#&gt; 9    0.5   NA     2     1 60  45
#&gt; 10   1.0   NA     2     1 60  45
#&gt; 11   2.0   NA     2     1 60  45
#&gt; 12   6.0   NA     2     1 60  45
#&gt; 13  24.0   NA     2     1 60  45
#&gt; 14  36.0   NA     2     1 60  45
#&gt; 15  72.0   NA     2     1 60  45
#&gt; 16 120.0   NA     2     1 60  45</div><div class='input'>(<span class='no'>df_9</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>))</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED Group Model WT AGE
#&gt; 1   1   0.5 NA    NA   NA     1     1 70  50
#&gt; 2   1   1.0 NA    NA   NA     1     1 70  50
#&gt; 3   1   2.0 NA    NA   NA     1     1 70  50
#&gt; 4   1   6.0 NA    NA   NA     1     1 70  50
#&gt; 5   1  24.0 NA    NA   NA     1     1 70  50
#&gt; 6   1  36.0 NA    NA   NA     1     1 70  50
#&gt; 7   1  72.0 NA    NA   NA     1     1 70  50
#&gt; 8   1 120.0 NA    NA   NA     1     1 70  50
#&gt; 9   2   0.5 NA    NA   NA     1     1 70  50
#&gt; 10  2   1.0 NA    NA   NA     1     1 70  50
#&gt; 11  2   2.0 NA    NA   NA     1     1 70  50
#&gt; 12  2   6.0 NA    NA   NA     1     1 70  50
#&gt; 13  2  24.0 NA    NA   NA     1     1 70  50
#&gt; 14  2  36.0 NA    NA   NA     1     1 70  50
#&gt; 15  2  72.0 NA    NA   NA     1     1 70  50
#&gt; 16  2 120.0 NA    NA   NA     1     1 70  50
#&gt; 17  3   0.5 NA    NA   NA     1     1 70  50
#&gt; 18  3   1.0 NA    NA   NA     1     1 70  50
#&gt; 19  3   2.0 NA    NA   NA     1     1 70  50
#&gt; 20  3   6.0 NA    NA   NA     1     1 70  50
#&gt; 21  3  24.0 NA    NA   NA     1     1 70  50
#&gt; 22  3  36.0 NA    NA   NA     1     1 70  50
#&gt; 23  3  72.0 NA    NA   NA     1     1 70  50
#&gt; 24  3 120.0 NA    NA   NA     1     1 70  50
#&gt; 25  4   0.5 NA    NA   NA     2     1 60  45
#&gt; 26  4   1.0 NA    NA   NA     2     1 60  45
#&gt; 27  4   2.0 NA    NA   NA     2     1 60  45
#&gt; 28  4   6.0 NA    NA   NA     2     1 60  45
#&gt; 29  4  24.0 NA    NA   NA     2     1 60  45
#&gt; 30  4  36.0 NA    NA   NA     2     1 60  45
#&gt; 31  4  72.0 NA    NA   NA     2     1 60  45
#&gt; 32  4 120.0 NA    NA   NA     2     1 60  45
#&gt; 33  5   0.5 NA    NA   NA     2     1 60  45
#&gt; 34  5   1.0 NA    NA   NA     2     1 60  45
#&gt; 35  5   2.0 NA    NA   NA     2     1 60  45
#&gt; 36  5   6.0 NA    NA   NA     2     1 60  45
#&gt; 37  5  24.0 NA    NA   NA     2     1 60  45
#&gt; 38  5  36.0 NA    NA   NA     2     1 60  45
#&gt; 39  5  72.0 NA    NA   NA     2     1 60  45
#&gt; 40  5 120.0 NA    NA   NA     2     1 60  45
#&gt; 41  6   0.5 NA    NA   NA     2     1 60  45
#&gt; 42  6   1.0 NA    NA   NA     2     1 60  45
#&gt; 43  6   2.0 NA    NA   NA     2     1 60  45
#&gt; 44  6   6.0 NA    NA   NA     2     1 60  45
#&gt; 45  6  24.0 NA    NA   NA     2     1 60  45
#&gt; 46  6  36.0 NA    NA   NA     2     1 60  45
#&gt; 47  6  72.0 NA    NA   NA     2     1 60  45
#&gt; 48  6 120.0 NA    NA   NA     2     1 60  45</div><div class='input'>
<span class='co'># generate random deviations in WT for each individual</span>
<span class='no'>df_10</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                          <span class='kw'>manipulation</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>({<span class='kw'>for</span>(<span class='no'>id</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>ID</span>))
                              <span class='no'>WT</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>] <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1</span>,<span class='no'>WT</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>],<span class='no'>WT</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>]*<span class='fl'>0.1</span>);<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>}))
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_10</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED Group Model       WT AGE
#&gt; 1   1   0.5 NA    NA   NA     1     1 69.30103  50
#&gt; 2   1   1.0 NA    NA   NA     1     1 69.30103  50
#&gt; 3   1   2.0 NA    NA   NA     1     1 69.30103  50
#&gt; 4   1   6.0 NA    NA   NA     1     1 69.30103  50
#&gt; 5   1  24.0 NA    NA   NA     1     1 69.30103  50
#&gt; 6   1  36.0 NA    NA   NA     1     1 69.30103  50
#&gt; 7   1  72.0 NA    NA   NA     1     1 69.30103  50
#&gt; 8   1 120.0 NA    NA   NA     1     1 69.30103  50
#&gt; 9   2   0.5 NA    NA   NA     1     1 70.32465  50
#&gt; 10  2   1.0 NA    NA   NA     1     1 70.32465  50
#&gt; 11  2   2.0 NA    NA   NA     1     1 70.32465  50
#&gt; 12  2   6.0 NA    NA   NA     1     1 70.32465  50
#&gt; 13  2  24.0 NA    NA   NA     1     1 70.32465  50
#&gt; 14  2  36.0 NA    NA   NA     1     1 70.32465  50
#&gt; 15  2  72.0 NA    NA   NA     1     1 70.32465  50
#&gt; 16  2 120.0 NA    NA   NA     1     1 70.32465  50
#&gt; 17  3   0.5 NA    NA   NA     1     1 77.19992  50
#&gt; 18  3   1.0 NA    NA   NA     1     1 77.19992  50
#&gt; 19  3   2.0 NA    NA   NA     1     1 77.19992  50
#&gt; 20  3   6.0 NA    NA   NA     1     1 77.19992  50</div><div class='input'>
<span class='co'># generate random deviations in WT and AGE for each individual</span>
<span class='no'>df_11</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                          <span class='kw'>manipulation</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
                            <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='kw'>for</span>(<span class='no'>id</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>ID</span>))
                              <span class='no'>WT</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>] <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1</span>,<span class='no'>WT</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>],<span class='no'>WT</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>]*<span class='fl'>0.1</span>)),
                            <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='kw'>for</span>(<span class='no'>id</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>ID</span>))
                              <span class='no'>AGE</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>] <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1</span>,<span class='no'>AGE</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>],<span class='no'>AGE</span>[<span class='no'>ID</span><span class='kw'>==</span><span class='no'>id</span>]*<span class='fl'>0.2</span>)),
                            <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>)
                          ))
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df_10</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED Group Model       WT AGE
#&gt; 1   1   0.5 NA    NA   NA     1     1 69.30103  50
#&gt; 2   1   1.0 NA    NA   NA     1     1 69.30103  50
#&gt; 3   1   2.0 NA    NA   NA     1     1 69.30103  50
#&gt; 4   1   6.0 NA    NA   NA     1     1 69.30103  50
#&gt; 5   1  24.0 NA    NA   NA     1     1 69.30103  50
#&gt; 6   1  36.0 NA    NA   NA     1     1 69.30103  50
#&gt; 7   1  72.0 NA    NA   NA     1     1 69.30103  50
#&gt; 8   1 120.0 NA    NA   NA     1     1 69.30103  50
#&gt; 9   2   0.5 NA    NA   NA     1     1 70.32465  50
#&gt; 10  2   1.0 NA    NA   NA     1     1 70.32465  50
#&gt; 11  2   2.0 NA    NA   NA     1     1 70.32465  50
#&gt; 12  2   6.0 NA    NA   NA     1     1 70.32465  50
#&gt; 13  2  24.0 NA    NA   NA     1     1 70.32465  50
#&gt; 14  2  36.0 NA    NA   NA     1     1 70.32465  50
#&gt; 15  2  72.0 NA    NA   NA     1     1 70.32465  50
#&gt; 16  2 120.0 NA    NA   NA     1     1 70.32465  50
#&gt; 17  3   0.5 NA    NA   NA     1     1 77.19992  50
#&gt; 18  3   1.0 NA    NA   NA     1     1 77.19992  50
#&gt; 19  3   2.0 NA    NA   NA     1     1 77.19992  50
#&gt; 20  3   6.0 NA    NA   NA     1     1 77.19992  50</div><div class='input'>
<span class='co'>## create dosing rows </span>
<span class='no'>dosing_1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>AMT</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>RATE</span><span class='kw'>=</span><span class='fl'>NA</span>,<span class='kw'>Time</span><span class='kw'>=</span><span class='fl'>0.5</span>),<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>AMT</span><span class='kw'>=</span><span class='fl'>3000</span>,<span class='kw'>RATE</span><span class='kw'>=</span><span class='fl'>NA</span>,<span class='kw'>Time</span><span class='kw'>=</span><span class='fl'>0.5</span>))
<span class='no'>dosing_2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>AMT</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>RATE</span><span class='kw'>=</span><span class='fl'>NA</span>,<span class='kw'>Time</span><span class='kw'>=</span><span class='fl'>0.5</span>))
<span class='no'>dosing_3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>AMT</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>Time</span><span class='kw'>=</span><span class='fl'>0.5</span>))
<span class='no'>dosing_4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>AMT</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1000</span>,<span class='fl'>20</span>),<span class='kw'>Time</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>,<span class='fl'>10</span>))) <span class='co'># multiple dosing</span>


(<span class='no'>df_12</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_1</span>))</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED  AMT RATE Group Model WT AGE
#&gt; 1   1   0.5 NA    NA   NA 1000   NA     1     1 70  50
#&gt; 2   1   0.5 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 3   1   1.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 4   1   2.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 5   1   6.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 6   1  24.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 7   1  36.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 8   1  72.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 9   1 120.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 10  2   0.5 NA    NA   NA 1000   NA     1     1 70  50
#&gt; 11  2   0.5 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 12  2   1.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 13  2   2.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 14  2   6.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 15  2  24.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 16  2  36.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 17  2  72.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 18  2 120.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 19  3   0.5 NA    NA   NA 1000   NA     1     1 70  50
#&gt; 20  3   0.5 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 21  3   1.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 22  3   2.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 23  3   6.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 24  3  24.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 25  3  36.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 26  3  72.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 27  3 120.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 28  4   0.5 NA    NA   NA 3000   NA     2     1 60  45
#&gt; 29  4   0.5 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 30  4   1.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 31  4   2.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 32  4   6.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 33  4  24.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 34  4  36.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 35  4  72.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 36  4 120.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 37  5   0.5 NA    NA   NA 3000   NA     2     1 60  45
#&gt; 38  5   0.5 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 39  5   1.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 40  5   2.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 41  5   6.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 42  5  24.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 43  5  36.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 44  5  72.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 45  5 120.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 46  6   0.5 NA    NA   NA 3000   NA     2     1 60  45
#&gt; 47  6   0.5 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 48  6   1.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 49  6   2.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 50  6   6.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 51  6  24.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 52  6  36.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 53  6  72.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 54  6 120.0 NA    NA   NA   NA   NA     2     1 60  45</div><div class='input'>(<span class='no'>df_13</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_2</span>))</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED  AMT RATE Group Model WT AGE
#&gt; 1   1   0.5 NA    NA   NA 1000   NA     1     1 70  50
#&gt; 2   1   0.5 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 3   1   1.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 4   1   2.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 5   1   6.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 6   1  24.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 7   1  36.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 8   1  72.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 9   1 120.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 10  2   0.5 NA    NA   NA 1000   NA     1     1 70  50
#&gt; 11  2   0.5 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 12  2   1.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 13  2   2.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 14  2   6.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 15  2  24.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 16  2  36.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 17  2  72.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 18  2 120.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 19  3   0.5 NA    NA   NA 1000   NA     1     1 70  50
#&gt; 20  3   0.5 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 21  3   1.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 22  3   2.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 23  3   6.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 24  3  24.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 25  3  36.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 26  3  72.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 27  3 120.0 NA    NA   NA   NA   NA     1     1 70  50
#&gt; 28  4   0.5 NA    NA   NA 1000   NA     2     1 60  45
#&gt; 29  4   0.5 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 30  4   1.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 31  4   2.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 32  4   6.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 33  4  24.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 34  4  36.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 35  4  72.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 36  4 120.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 37  5   0.5 NA    NA   NA 1000   NA     2     1 60  45
#&gt; 38  5   0.5 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 39  5   1.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 40  5   2.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 41  5   6.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 42  5  24.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 43  5  36.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 44  5  72.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 45  5 120.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 46  6   0.5 NA    NA   NA 1000   NA     2     1 60  45
#&gt; 47  6   0.5 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 48  6   1.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 49  6   2.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 50  6   6.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 51  6  24.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 52  6  36.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 53  6  72.0 NA    NA   NA   NA   NA     2     1 60  45
#&gt; 54  6 120.0 NA    NA   NA   NA   NA     2     1 60  45</div><div class='input'>(<span class='no'>df_14</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_3</span>))</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1   1   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 2   1   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 3   1   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 4   1   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 5   1   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 6   1  24.0 NA    NA   NA   NA     1     1 70  50
#&gt; 7   1  36.0 NA    NA   NA   NA     1     1 70  50
#&gt; 8   1  72.0 NA    NA   NA   NA     1     1 70  50
#&gt; 9   1 120.0 NA    NA   NA   NA     1     1 70  50
#&gt; 10  2   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 11  2   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 12  2   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 13  2   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 14  2   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 15  2  24.0 NA    NA   NA   NA     1     1 70  50
#&gt; 16  2  36.0 NA    NA   NA   NA     1     1 70  50
#&gt; 17  2  72.0 NA    NA   NA   NA     1     1 70  50
#&gt; 18  2 120.0 NA    NA   NA   NA     1     1 70  50
#&gt; 19  3   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 20  3   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 21  3   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 22  3   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 23  3   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 24  3  24.0 NA    NA   NA   NA     1     1 70  50
#&gt; 25  3  36.0 NA    NA   NA   NA     1     1 70  50
#&gt; 26  3  72.0 NA    NA   NA   NA     1     1 70  50
#&gt; 27  3 120.0 NA    NA   NA   NA     1     1 70  50
#&gt; 28  4   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 29  4   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 30  4   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 31  4   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 32  4   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 33  4  24.0 NA    NA   NA   NA     2     1 60  45
#&gt; 34  4  36.0 NA    NA   NA   NA     2     1 60  45
#&gt; 35  4  72.0 NA    NA   NA   NA     2     1 60  45
#&gt; 36  4 120.0 NA    NA   NA   NA     2     1 60  45
#&gt; 37  5   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 38  5   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 39  5   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 40  5   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 41  5   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 42  5  24.0 NA    NA   NA   NA     2     1 60  45
#&gt; 43  5  36.0 NA    NA   NA   NA     2     1 60  45
#&gt; 44  5  72.0 NA    NA   NA   NA     2     1 60  45
#&gt; 45  5 120.0 NA    NA   NA   NA     2     1 60  45
#&gt; 46  6   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 47  6   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 48  6   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 49  6   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 50  6   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 51  6  24.0 NA    NA   NA   NA     2     1 60  45
#&gt; 52  6  36.0 NA    NA   NA   NA     2     1 60  45
#&gt; 53  6  72.0 NA    NA   NA   NA     2     1 60  45
#&gt; 54  6 120.0 NA    NA   NA   NA     2     1 60  45</div><div class='input'>(<span class='no'>df_15</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>))</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1   1   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 2   1   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 3   1   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 4   1   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 5   1   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 6   1  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 7   1  24.0 NA    NA   NA   NA     1     1 70  50
#&gt; 8   1  36.0 NA    NA   NA   NA     1     1 70  50
#&gt; 9   1  72.0 NA    NA   NA   NA     1     1 70  50
#&gt; 10  1 120.0 NA    NA   NA   NA     1     1 70  50
#&gt; 11  2   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 12  2   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 13  2   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 14  2   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 15  2   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 16  2  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 17  2  24.0 NA    NA   NA   NA     1     1 70  50
#&gt; 18  2  36.0 NA    NA   NA   NA     1     1 70  50
#&gt; 19  2  72.0 NA    NA   NA   NA     1     1 70  50
#&gt; 20  2 120.0 NA    NA   NA   NA     1     1 70  50
#&gt; 21  3   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 22  3   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 23  3   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 24  3   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 25  3   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 26  3  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 27  3  24.0 NA    NA   NA   NA     1     1 70  50
#&gt; 28  3  36.0 NA    NA   NA   NA     1     1 70  50
#&gt; 29  3  72.0 NA    NA   NA   NA     1     1 70  50
#&gt; 30  3 120.0 NA    NA   NA   NA     1     1 70  50
#&gt; 31  4   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 32  4   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 33  4   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 34  4   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 35  4   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 36  4  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 37  4  24.0 NA    NA   NA   NA     2     1 60  45
#&gt; 38  4  36.0 NA    NA   NA   NA     2     1 60  45
#&gt; 39  4  72.0 NA    NA   NA   NA     2     1 60  45
#&gt; 40  4 120.0 NA    NA   NA   NA     2     1 60  45
#&gt; 41  5   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 42  5   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 43  5   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 44  5   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 45  5   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 46  5  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 47  5  24.0 NA    NA   NA   NA     2     1 60  45
#&gt; 48  5  36.0 NA    NA   NA   NA     2     1 60  45
#&gt; 49  5  72.0 NA    NA   NA   NA     2     1 60  45
#&gt; 50  5 120.0 NA    NA   NA   NA     2     1 60  45
#&gt; 51  6   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 52  6   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 53  6   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 54  6   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 55  6   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 56  6  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 57  6  24.0 NA    NA   NA   NA     2     1 60  45
#&gt; 58  6  36.0 NA    NA   NA   NA     2     1 60  45
#&gt; 59  6  72.0 NA    NA   NA   NA     2     1 60  45
#&gt; 60  6 120.0 NA    NA   NA   NA     2     1 60  45</div><div class='input'>
<span class='no'>df_16</span> <span class='kw'>&lt;-</span> <span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>filename</span><span class='kw'>=</span><span class='st'>"test.csv"</span>)

<span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt;     ID      Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1    1   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 2    1   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 3    1   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 4    1   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 5    1   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 6    1  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 7    1  13.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 8    1  24.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 9    1  27.05556 NA    NA   NA   NA     1     1 70  50
#&gt; 10   1  36.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 11   1  40.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 12   1  53.61111 NA    NA   NA   NA     1     1 70  50
#&gt; 13   1  66.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 14   1  72.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 15   1  80.16667 NA    NA   NA   NA     1     1 70  50
#&gt; 16   1  93.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 17   1 106.72222 NA    NA   NA   NA     1     1 70  50
#&gt; 18   1 120.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 19   2   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 20   2   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 21   2   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 22   2   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 23   2   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 24   2  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 25   2  13.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 26   2  24.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 27   2  27.05556 NA    NA   NA   NA     1     1 70  50
#&gt; 28   2  36.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 29   2  40.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 30   2  53.61111 NA    NA   NA   NA     1     1 70  50
#&gt; 31   2  66.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 32   2  72.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 33   2  80.16667 NA    NA   NA   NA     1     1 70  50
#&gt; 34   2  93.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 35   2 106.72222 NA    NA   NA   NA     1     1 70  50
#&gt; 36   2 120.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 37   3   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 38   3   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 39   3   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 40   3   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 41   3   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 42   3  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 43   3  13.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 44   3  24.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 45   3  27.05556 NA    NA   NA   NA     1     1 70  50
#&gt; 46   3  36.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 47   3  40.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 48   3  53.61111 NA    NA   NA   NA     1     1 70  50
#&gt; 49   3  66.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 50   3  72.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 51   3  80.16667 NA    NA   NA   NA     1     1 70  50
#&gt; 52   3  93.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 53   3 106.72222 NA    NA   NA   NA     1     1 70  50
#&gt; 54   3 120.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 55   4   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 56   4   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 57   4   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 58   4   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 59   4   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 60   4  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 61   4  13.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 62   4  24.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 63   4  27.05556 NA    NA   NA   NA     2     1 60  45
#&gt; 64   4  36.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 65   4  40.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 66   4  53.61111 NA    NA   NA   NA     2     1 60  45
#&gt; 67   4  66.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 68   4  72.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 69   4  80.16667 NA    NA   NA   NA     2     1 60  45
#&gt; 70   4  93.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 71   4 106.72222 NA    NA   NA   NA     2     1 60  45
#&gt; 72   4 120.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 73   5   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 74   5   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 75   5   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 76   5   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 77   5   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 78   5  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 79   5  13.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 80   5  24.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 81   5  27.05556 NA    NA   NA   NA     2     1 60  45
#&gt; 82   5  36.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 83   5  40.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 84   5  53.61111 NA    NA   NA   NA     2     1 60  45
#&gt; 85   5  66.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 86   5  72.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 87   5  80.16667 NA    NA   NA   NA     2     1 60  45
#&gt; 88   5  93.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 89   5 106.72222 NA    NA   NA   NA     2     1 60  45
#&gt; 90   5 120.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 91   6   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 92   6   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 93   6   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 94   6   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 95   6   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 96   6  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 97   6  13.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 98   6  24.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 99   6  27.05556 NA    NA   NA   NA     2     1 60  45
#&gt; 100  6  36.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 101  6  40.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 102  6  53.61111 NA    NA   NA   NA     2     1 60  45
#&gt; 103  6  66.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 104  6  72.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 105  6  80.16667 NA    NA   NA   NA     2     1 60  45
#&gt; 106  6  93.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 107  6 106.72222 NA    NA   NA   NA     2     1 60  45
#&gt; 108  6 120.00000 NA    NA   NA   NA     2     1 60  45</div><div class='input'><span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_3</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='fl'>10</span>,<span class='kw'>model_minxt</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt;     ID      Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1    1   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 2    1   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 3    1   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 4    1   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 5    1   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 6    1  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 7    1  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 8    1  24.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 9    1  31.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 10   1  36.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 11   1  42.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 12   1  53.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 13   1  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 14   1  72.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 15   1  75.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 16   1  86.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 17   1  97.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 18   1 108.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 19   1 120.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 20   2   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 21   2   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 22   2   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 23   2   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 24   2   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 25   2  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 26   2  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 27   2  24.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 28   2  31.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 29   2  36.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 30   2  42.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 31   2  53.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 32   2  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 33   2  72.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 34   2  75.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 35   2  86.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 36   2  97.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 37   2 108.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 38   2 120.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 39   3   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 40   3   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 41   3   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 42   3   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 43   3   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 44   3  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 45   3  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 46   3  24.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 47   3  31.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 48   3  36.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 49   3  42.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 50   3  53.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 51   3  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 52   3  72.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 53   3  75.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 54   3  86.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 55   3  97.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 56   3 108.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 57   3 120.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 58   4   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 59   4   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 60   4   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 61   4   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 62   4   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 63   4  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 64   4  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 65   4  24.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 66   4  31.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 67   4  36.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 68   4  42.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 69   4  53.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 70   4  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 71   4  72.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 72   4  75.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 73   4  86.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 74   4  97.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 75   4 108.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 76   4 120.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 77   5   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 78   5   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 79   5   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 80   5   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 81   5   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 82   5  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 83   5  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 84   5  24.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 85   5  31.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 86   5  36.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 87   5  42.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 88   5  53.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 89   5  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 90   5  72.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 91   5  75.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 92   5  86.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 93   5  97.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 94   5 108.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 95   5 120.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 96   6   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 97   6   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 98   6   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 99   6   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 100  6   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 101  6  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 102  6  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 103  6  24.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 104  6  31.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 105  6  36.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 106  6  42.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 107  6  53.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 108  6  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 109  6  72.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 110  6  75.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 111  6  86.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 112  6  97.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 113  6 108.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 114  6 120.00000 NA    NA   NA   NA     2     1 60  45</div><div class='input'>
<span class='no'>design_4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
  <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
  <span class='kw'>model_switch</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>),
  <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>2</span>,
  <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fl'>3</span>,
  <span class='kw'>a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>WT</span><span class='kw'>=</span><span class='fl'>70</span>,<span class='kw'>AGE</span><span class='kw'>=</span><span class='fl'>50</span>),<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>AGE</span><span class='kw'>=</span><span class='fl'>45</span>,<span class='kw'>WT</span><span class='kw'>=</span><span class='fl'>60</span>)))

<span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_4</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>)</div><div class='output co'>#&gt;    ID  Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1   1   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 2   1   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 3   1   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 4   1   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 5   1   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 6   1  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 7   1  24.0 NA    NA   NA   NA     1     2 70  50
#&gt; 8   1  36.0 NA    NA   NA   NA     1     2 70  50
#&gt; 9   1  72.0 NA    NA   NA   NA     1     2 70  50
#&gt; 10  1 120.0 NA    NA   NA   NA     1     2 70  50
#&gt; 11  2   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 12  2   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 13  2   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 14  2   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 15  2   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 16  2  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 17  2  24.0 NA    NA   NA   NA     1     2 70  50
#&gt; 18  2  36.0 NA    NA   NA   NA     1     2 70  50
#&gt; 19  2  72.0 NA    NA   NA   NA     1     2 70  50
#&gt; 20  2 120.0 NA    NA   NA   NA     1     2 70  50
#&gt; 21  3   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 22  3   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 23  3   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 24  3   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 25  3   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 26  3  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 27  3  24.0 NA    NA   NA   NA     1     2 70  50
#&gt; 28  3  36.0 NA    NA   NA   NA     1     2 70  50
#&gt; 29  3  72.0 NA    NA   NA   NA     1     2 70  50
#&gt; 30  3 120.0 NA    NA   NA   NA     1     2 70  50
#&gt; 31  4   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 32  4   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 33  4   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 34  4   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 35  4   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 36  4  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 37  4  24.0 NA    NA   NA   NA     2     2 60  45
#&gt; 38  4  36.0 NA    NA   NA   NA     2     2 60  45
#&gt; 39  4  72.0 NA    NA   NA   NA     2     2 60  45
#&gt; 40  4 120.0 NA    NA   NA   NA     2     2 60  45
#&gt; 41  5   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 42  5   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 43  5   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 44  5   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 45  5   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 46  5  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 47  5  24.0 NA    NA   NA   NA     2     2 60  45
#&gt; 48  5  36.0 NA    NA   NA   NA     2     2 60  45
#&gt; 49  5  72.0 NA    NA   NA   NA     2     2 60  45
#&gt; 50  5 120.0 NA    NA   NA   NA     2     2 60  45
#&gt; 51  6   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 52  6   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 53  6   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 54  6   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 55  6   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 56  6  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 57  6  24.0 NA    NA   NA   NA     2     2 60  45
#&gt; 58  6  36.0 NA    NA   NA   NA     2     2 60  45
#&gt; 59  6  72.0 NA    NA   NA   NA     2     2 60  45
#&gt; 60  6 120.0 NA    NA   NA   NA     2     2 60  45</div><div class='input'><span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_4</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt;     ID       Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1    1   0.500000 NA    NA   NA 1000     1     1 70  50
#&gt; 2    1   0.500000 NA    NA   NA   NA     1     1 70  50
#&gt; 3    1   1.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 4    1   1.111111 NA    NA   NA   NA     1     1 70  50
#&gt; 5    1   1.722222 NA    NA   NA   NA     1     1 70  50
#&gt; 6    1   2.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 7    1   2.333333 NA    NA   NA   NA     1     1 70  50
#&gt; 8    1   2.944444 NA    NA   NA   NA     1     1 70  50
#&gt; 9    1   3.555556 NA    NA   NA   NA     1     1 70  50
#&gt; 10   1   4.166667 NA    NA   NA   NA     1     1 70  50
#&gt; 11   1   4.777778 NA    NA   NA   NA     1     1 70  50
#&gt; 12   1   5.388889 NA    NA   NA   NA     1     1 70  50
#&gt; 13   1   6.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 14   1  10.000000 NA    NA   NA   20     1     1 70  50
#&gt; 15   1  24.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 16   1  34.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 17   1  36.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 18   1  45.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 19   1  56.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 20   1  66.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 21   1  72.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 22   1  77.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 23   1  88.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 24   1  98.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 25   1 109.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 26   1 120.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 27   2   0.500000 NA    NA   NA 1000     1     1 70  50
#&gt; 28   2   0.500000 NA    NA   NA   NA     1     1 70  50
#&gt; 29   2   1.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 30   2   1.111111 NA    NA   NA   NA     1     1 70  50
#&gt; 31   2   1.722222 NA    NA   NA   NA     1     1 70  50
#&gt; 32   2   2.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 33   2   2.333333 NA    NA   NA   NA     1     1 70  50
#&gt; 34   2   2.944444 NA    NA   NA   NA     1     1 70  50
#&gt; 35   2   3.555556 NA    NA   NA   NA     1     1 70  50
#&gt; 36   2   4.166667 NA    NA   NA   NA     1     1 70  50
#&gt; 37   2   4.777778 NA    NA   NA   NA     1     1 70  50
#&gt; 38   2   5.388889 NA    NA   NA   NA     1     1 70  50
#&gt; 39   2   6.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 40   2  10.000000 NA    NA   NA   20     1     1 70  50
#&gt; 41   2  24.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 42   2  34.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 43   2  36.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 44   2  45.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 45   2  56.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 46   2  66.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 47   2  72.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 48   2  77.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 49   2  88.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 50   2  98.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 51   2 109.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 52   2 120.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 53   3   0.500000 NA    NA   NA 1000     1     1 70  50
#&gt; 54   3   0.500000 NA    NA   NA   NA     1     1 70  50
#&gt; 55   3   1.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 56   3   1.111111 NA    NA   NA   NA     1     1 70  50
#&gt; 57   3   1.722222 NA    NA   NA   NA     1     1 70  50
#&gt; 58   3   2.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 59   3   2.333333 NA    NA   NA   NA     1     1 70  50
#&gt; 60   3   2.944444 NA    NA   NA   NA     1     1 70  50
#&gt; 61   3   3.555556 NA    NA   NA   NA     1     1 70  50
#&gt; 62   3   4.166667 NA    NA   NA   NA     1     1 70  50
#&gt; 63   3   4.777778 NA    NA   NA   NA     1     1 70  50
#&gt; 64   3   5.388889 NA    NA   NA   NA     1     1 70  50
#&gt; 65   3   6.000000 NA    NA   NA   NA     1     1 70  50
#&gt; 66   3  10.000000 NA    NA   NA   20     1     1 70  50
#&gt; 67   3  24.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 68   3  34.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 69   3  36.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 70   3  45.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 71   3  56.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 72   3  66.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 73   3  72.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 74   3  77.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 75   3  88.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 76   3  98.666667 NA    NA   NA   NA     1     2 70  50
#&gt; 77   3 109.333333 NA    NA   NA   NA     1     2 70  50
#&gt; 78   3 120.000000 NA    NA   NA   NA     1     2 70  50
#&gt; 79   4   0.500000 NA    NA   NA 1000     2     1 60  45
#&gt; 80   4   0.500000 NA    NA   NA   NA     2     1 60  45
#&gt; 81   4   1.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 82   4   1.111111 NA    NA   NA   NA     2     1 60  45
#&gt; 83   4   1.722222 NA    NA   NA   NA     2     1 60  45
#&gt; 84   4   2.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 85   4   2.333333 NA    NA   NA   NA     2     1 60  45
#&gt; 86   4   2.944444 NA    NA   NA   NA     2     1 60  45
#&gt; 87   4   3.555556 NA    NA   NA   NA     2     1 60  45
#&gt; 88   4   4.166667 NA    NA   NA   NA     2     1 60  45
#&gt; 89   4   4.777778 NA    NA   NA   NA     2     1 60  45
#&gt; 90   4   5.388889 NA    NA   NA   NA     2     1 60  45
#&gt; 91   4   6.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 92   4  10.000000 NA    NA   NA   20     2     1 60  45
#&gt; 93   4  24.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 94   4  34.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 95   4  36.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 96   4  45.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 97   4  56.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 98   4  66.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 99   4  72.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 100  4  77.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 101  4  88.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 102  4  98.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 103  4 109.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 104  4 120.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 105  5   0.500000 NA    NA   NA 1000     2     1 60  45
#&gt; 106  5   0.500000 NA    NA   NA   NA     2     1 60  45
#&gt; 107  5   1.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 108  5   1.111111 NA    NA   NA   NA     2     1 60  45
#&gt; 109  5   1.722222 NA    NA   NA   NA     2     1 60  45
#&gt; 110  5   2.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 111  5   2.333333 NA    NA   NA   NA     2     1 60  45
#&gt; 112  5   2.944444 NA    NA   NA   NA     2     1 60  45
#&gt; 113  5   3.555556 NA    NA   NA   NA     2     1 60  45
#&gt; 114  5   4.166667 NA    NA   NA   NA     2     1 60  45
#&gt; 115  5   4.777778 NA    NA   NA   NA     2     1 60  45
#&gt; 116  5   5.388889 NA    NA   NA   NA     2     1 60  45
#&gt; 117  5   6.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 118  5  10.000000 NA    NA   NA   20     2     1 60  45
#&gt; 119  5  24.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 120  5  34.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 121  5  36.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 122  5  45.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 123  5  56.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 124  5  66.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 125  5  72.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 126  5  77.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 127  5  88.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 128  5  98.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 129  5 109.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 130  5 120.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 131  6   0.500000 NA    NA   NA 1000     2     1 60  45
#&gt; 132  6   0.500000 NA    NA   NA   NA     2     1 60  45
#&gt; 133  6   1.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 134  6   1.111111 NA    NA   NA   NA     2     1 60  45
#&gt; 135  6   1.722222 NA    NA   NA   NA     2     1 60  45
#&gt; 136  6   2.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 137  6   2.333333 NA    NA   NA   NA     2     1 60  45
#&gt; 138  6   2.944444 NA    NA   NA   NA     2     1 60  45
#&gt; 139  6   3.555556 NA    NA   NA   NA     2     1 60  45
#&gt; 140  6   4.166667 NA    NA   NA   NA     2     1 60  45
#&gt; 141  6   4.777778 NA    NA   NA   NA     2     1 60  45
#&gt; 142  6   5.388889 NA    NA   NA   NA     2     1 60  45
#&gt; 143  6   6.000000 NA    NA   NA   NA     2     1 60  45
#&gt; 144  6  10.000000 NA    NA   NA   20     2     1 60  45
#&gt; 145  6  24.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 146  6  34.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 147  6  36.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 148  6  45.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 149  6  56.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 150  6  66.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 151  6  72.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 152  6  77.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 153  6  88.000000 NA    NA   NA   NA     2     2 60  45
#&gt; 154  6  98.666667 NA    NA   NA   NA     2     2 60  45
#&gt; 155  6 109.333333 NA    NA   NA   NA     2     2 60  45
#&gt; 156  6 120.000000 NA    NA   NA   NA     2     2 60  45</div><div class='input'><span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_4</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                 <span class='kw'>model_minxt</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>model_maxxt</span><span class='kw'>=</span><span class='fl'>100</span>)</div><div class='output co'>#&gt;     ID  Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1    1   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 2    1   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 3    1   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 4    1   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 5    1   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 6    1  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 7    1  10.0 NA    NA   NA   NA     1     1 70  50
#&gt; 8    1  10.0 NA    NA   NA   NA     1     2 70  50
#&gt; 9    1  20.0 NA    NA   NA   NA     1     1 70  50
#&gt; 10   1  20.0 NA    NA   NA   NA     1     2 70  50
#&gt; 11   1  24.0 NA    NA   NA   NA     1     2 70  50
#&gt; 12   1  30.0 NA    NA   NA   NA     1     1 70  50
#&gt; 13   1  30.0 NA    NA   NA   NA     1     2 70  50
#&gt; 14   1  36.0 NA    NA   NA   NA     1     2 70  50
#&gt; 15   1  40.0 NA    NA   NA   NA     1     1 70  50
#&gt; 16   1  40.0 NA    NA   NA   NA     1     2 70  50
#&gt; 17   1  50.0 NA    NA   NA   NA     1     1 70  50
#&gt; 18   1  50.0 NA    NA   NA   NA     1     2 70  50
#&gt; 19   1  60.0 NA    NA   NA   NA     1     1 70  50
#&gt; 20   1  60.0 NA    NA   NA   NA     1     2 70  50
#&gt; 21   1  70.0 NA    NA   NA   NA     1     1 70  50
#&gt; 22   1  70.0 NA    NA   NA   NA     1     2 70  50
#&gt; 23   1  72.0 NA    NA   NA   NA     1     2 70  50
#&gt; 24   1  80.0 NA    NA   NA   NA     1     1 70  50
#&gt; 25   1  80.0 NA    NA   NA   NA     1     2 70  50
#&gt; 26   1  90.0 NA    NA   NA   NA     1     1 70  50
#&gt; 27   1  90.0 NA    NA   NA   NA     1     2 70  50
#&gt; 28   1 100.0 NA    NA   NA   NA     1     1 70  50
#&gt; 29   1 100.0 NA    NA   NA   NA     1     2 70  50
#&gt; 30   1 120.0 NA    NA   NA   NA     1     2 70  50
#&gt; 31   2   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 32   2   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 33   2   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 34   2   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 35   2   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 36   2  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 37   2  10.0 NA    NA   NA   NA     1     1 70  50
#&gt; 38   2  10.0 NA    NA   NA   NA     1     2 70  50
#&gt; 39   2  20.0 NA    NA   NA   NA     1     1 70  50
#&gt; 40   2  20.0 NA    NA   NA   NA     1     2 70  50
#&gt; 41   2  24.0 NA    NA   NA   NA     1     2 70  50
#&gt; 42   2  30.0 NA    NA   NA   NA     1     1 70  50
#&gt; 43   2  30.0 NA    NA   NA   NA     1     2 70  50
#&gt; 44   2  36.0 NA    NA   NA   NA     1     2 70  50
#&gt; 45   2  40.0 NA    NA   NA   NA     1     1 70  50
#&gt; 46   2  40.0 NA    NA   NA   NA     1     2 70  50
#&gt; 47   2  50.0 NA    NA   NA   NA     1     1 70  50
#&gt; 48   2  50.0 NA    NA   NA   NA     1     2 70  50
#&gt; 49   2  60.0 NA    NA   NA   NA     1     1 70  50
#&gt; 50   2  60.0 NA    NA   NA   NA     1     2 70  50
#&gt; 51   2  70.0 NA    NA   NA   NA     1     1 70  50
#&gt; 52   2  70.0 NA    NA   NA   NA     1     2 70  50
#&gt; 53   2  72.0 NA    NA   NA   NA     1     2 70  50
#&gt; 54   2  80.0 NA    NA   NA   NA     1     1 70  50
#&gt; 55   2  80.0 NA    NA   NA   NA     1     2 70  50
#&gt; 56   2  90.0 NA    NA   NA   NA     1     1 70  50
#&gt; 57   2  90.0 NA    NA   NA   NA     1     2 70  50
#&gt; 58   2 100.0 NA    NA   NA   NA     1     1 70  50
#&gt; 59   2 100.0 NA    NA   NA   NA     1     2 70  50
#&gt; 60   2 120.0 NA    NA   NA   NA     1     2 70  50
#&gt; 61   3   0.5 NA    NA   NA 1000     1     1 70  50
#&gt; 62   3   0.5 NA    NA   NA   NA     1     1 70  50
#&gt; 63   3   1.0 NA    NA   NA   NA     1     1 70  50
#&gt; 64   3   2.0 NA    NA   NA   NA     1     1 70  50
#&gt; 65   3   6.0 NA    NA   NA   NA     1     1 70  50
#&gt; 66   3  10.0 NA    NA   NA   20     1     1 70  50
#&gt; 67   3  10.0 NA    NA   NA   NA     1     1 70  50
#&gt; 68   3  10.0 NA    NA   NA   NA     1     2 70  50
#&gt; 69   3  20.0 NA    NA   NA   NA     1     1 70  50
#&gt; 70   3  20.0 NA    NA   NA   NA     1     2 70  50
#&gt; 71   3  24.0 NA    NA   NA   NA     1     2 70  50
#&gt; 72   3  30.0 NA    NA   NA   NA     1     1 70  50
#&gt; 73   3  30.0 NA    NA   NA   NA     1     2 70  50
#&gt; 74   3  36.0 NA    NA   NA   NA     1     2 70  50
#&gt; 75   3  40.0 NA    NA   NA   NA     1     1 70  50
#&gt; 76   3  40.0 NA    NA   NA   NA     1     2 70  50
#&gt; 77   3  50.0 NA    NA   NA   NA     1     1 70  50
#&gt; 78   3  50.0 NA    NA   NA   NA     1     2 70  50
#&gt; 79   3  60.0 NA    NA   NA   NA     1     1 70  50
#&gt; 80   3  60.0 NA    NA   NA   NA     1     2 70  50
#&gt; 81   3  70.0 NA    NA   NA   NA     1     1 70  50
#&gt; 82   3  70.0 NA    NA   NA   NA     1     2 70  50
#&gt; 83   3  72.0 NA    NA   NA   NA     1     2 70  50
#&gt; 84   3  80.0 NA    NA   NA   NA     1     1 70  50
#&gt; 85   3  80.0 NA    NA   NA   NA     1     2 70  50
#&gt; 86   3  90.0 NA    NA   NA   NA     1     1 70  50
#&gt; 87   3  90.0 NA    NA   NA   NA     1     2 70  50
#&gt; 88   3 100.0 NA    NA   NA   NA     1     1 70  50
#&gt; 89   3 100.0 NA    NA   NA   NA     1     2 70  50
#&gt; 90   3 120.0 NA    NA   NA   NA     1     2 70  50
#&gt; 91   4   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 92   4   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 93   4   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 94   4   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 95   4   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 96   4  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 97   4  10.0 NA    NA   NA   NA     2     1 60  45
#&gt; 98   4  10.0 NA    NA   NA   NA     2     2 60  45
#&gt; 99   4  20.0 NA    NA   NA   NA     2     1 60  45
#&gt; 100  4  20.0 NA    NA   NA   NA     2     2 60  45
#&gt; 101  4  24.0 NA    NA   NA   NA     2     2 60  45
#&gt; 102  4  30.0 NA    NA   NA   NA     2     1 60  45
#&gt; 103  4  30.0 NA    NA   NA   NA     2     2 60  45
#&gt; 104  4  36.0 NA    NA   NA   NA     2     2 60  45
#&gt; 105  4  40.0 NA    NA   NA   NA     2     1 60  45
#&gt; 106  4  40.0 NA    NA   NA   NA     2     2 60  45
#&gt; 107  4  50.0 NA    NA   NA   NA     2     1 60  45
#&gt; 108  4  50.0 NA    NA   NA   NA     2     2 60  45
#&gt; 109  4  60.0 NA    NA   NA   NA     2     1 60  45
#&gt; 110  4  60.0 NA    NA   NA   NA     2     2 60  45
#&gt; 111  4  70.0 NA    NA   NA   NA     2     1 60  45
#&gt; 112  4  70.0 NA    NA   NA   NA     2     2 60  45
#&gt; 113  4  72.0 NA    NA   NA   NA     2     2 60  45
#&gt; 114  4  80.0 NA    NA   NA   NA     2     1 60  45
#&gt; 115  4  80.0 NA    NA   NA   NA     2     2 60  45
#&gt; 116  4  90.0 NA    NA   NA   NA     2     1 60  45
#&gt; 117  4  90.0 NA    NA   NA   NA     2     2 60  45
#&gt; 118  4 100.0 NA    NA   NA   NA     2     1 60  45
#&gt; 119  4 100.0 NA    NA   NA   NA     2     2 60  45
#&gt; 120  4 120.0 NA    NA   NA   NA     2     2 60  45
#&gt; 121  5   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 122  5   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 123  5   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 124  5   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 125  5   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 126  5  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 127  5  10.0 NA    NA   NA   NA     2     1 60  45
#&gt; 128  5  10.0 NA    NA   NA   NA     2     2 60  45
#&gt; 129  5  20.0 NA    NA   NA   NA     2     1 60  45
#&gt; 130  5  20.0 NA    NA   NA   NA     2     2 60  45
#&gt; 131  5  24.0 NA    NA   NA   NA     2     2 60  45
#&gt; 132  5  30.0 NA    NA   NA   NA     2     1 60  45
#&gt; 133  5  30.0 NA    NA   NA   NA     2     2 60  45
#&gt; 134  5  36.0 NA    NA   NA   NA     2     2 60  45
#&gt; 135  5  40.0 NA    NA   NA   NA     2     1 60  45
#&gt; 136  5  40.0 NA    NA   NA   NA     2     2 60  45
#&gt; 137  5  50.0 NA    NA   NA   NA     2     1 60  45
#&gt; 138  5  50.0 NA    NA   NA   NA     2     2 60  45
#&gt; 139  5  60.0 NA    NA   NA   NA     2     1 60  45
#&gt; 140  5  60.0 NA    NA   NA   NA     2     2 60  45
#&gt; 141  5  70.0 NA    NA   NA   NA     2     1 60  45
#&gt; 142  5  70.0 NA    NA   NA   NA     2     2 60  45
#&gt; 143  5  72.0 NA    NA   NA   NA     2     2 60  45
#&gt; 144  5  80.0 NA    NA   NA   NA     2     1 60  45
#&gt; 145  5  80.0 NA    NA   NA   NA     2     2 60  45
#&gt; 146  5  90.0 NA    NA   NA   NA     2     1 60  45
#&gt; 147  5  90.0 NA    NA   NA   NA     2     2 60  45
#&gt; 148  5 100.0 NA    NA   NA   NA     2     1 60  45
#&gt; 149  5 100.0 NA    NA   NA   NA     2     2 60  45
#&gt; 150  5 120.0 NA    NA   NA   NA     2     2 60  45
#&gt; 151  6   0.5 NA    NA   NA 1000     2     1 60  45
#&gt; 152  6   0.5 NA    NA   NA   NA     2     1 60  45
#&gt; 153  6   1.0 NA    NA   NA   NA     2     1 60  45
#&gt; 154  6   2.0 NA    NA   NA   NA     2     1 60  45
#&gt; 155  6   6.0 NA    NA   NA   NA     2     1 60  45
#&gt; 156  6  10.0 NA    NA   NA   20     2     1 60  45
#&gt; 157  6  10.0 NA    NA   NA   NA     2     1 60  45
#&gt; 158  6  10.0 NA    NA   NA   NA     2     2 60  45
#&gt; 159  6  20.0 NA    NA   NA   NA     2     1 60  45
#&gt; 160  6  20.0 NA    NA   NA   NA     2     2 60  45
#&gt; 161  6  24.0 NA    NA   NA   NA     2     2 60  45
#&gt; 162  6  30.0 NA    NA   NA   NA     2     1 60  45
#&gt; 163  6  30.0 NA    NA   NA   NA     2     2 60  45
#&gt; 164  6  36.0 NA    NA   NA   NA     2     2 60  45
#&gt; 165  6  40.0 NA    NA   NA   NA     2     1 60  45
#&gt; 166  6  40.0 NA    NA   NA   NA     2     2 60  45
#&gt; 167  6  50.0 NA    NA   NA   NA     2     1 60  45
#&gt; 168  6  50.0 NA    NA   NA   NA     2     2 60  45
#&gt; 169  6  60.0 NA    NA   NA   NA     2     1 60  45
#&gt; 170  6  60.0 NA    NA   NA   NA     2     2 60  45
#&gt; 171  6  70.0 NA    NA   NA   NA     2     1 60  45
#&gt; 172  6  70.0 NA    NA   NA   NA     2     2 60  45
#&gt; 173  6  72.0 NA    NA   NA   NA     2     2 60  45
#&gt; 174  6  80.0 NA    NA   NA   NA     2     1 60  45
#&gt; 175  6  80.0 NA    NA   NA   NA     2     2 60  45
#&gt; 176  6  90.0 NA    NA   NA   NA     2     1 60  45
#&gt; 177  6  90.0 NA    NA   NA   NA     2     2 60  45
#&gt; 178  6 100.0 NA    NA   NA   NA     2     1 60  45
#&gt; 179  6 100.0 NA    NA   NA   NA     2     2 60  45
#&gt; 180  6 120.0 NA    NA   NA   NA     2     2 60  45</div><div class='input'><span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_4</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                 <span class='kw'>model_minxt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>,<span class='fl'>20</span>),<span class='kw'>model_maxxt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>100</span>))</div><div class='output co'>#&gt;     ID      Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1    1   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 2    1   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 3    1   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 4    1   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 5    1   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 6    1  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 7    1  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 8    1  20.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 9    1  24.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 10   1  28.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 11   1  28.88889 NA    NA   NA   NA     1     2 70  50
#&gt; 12   1  36.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 13   1  37.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 14   1  37.77778 NA    NA   NA   NA     1     2 70  50
#&gt; 15   1  46.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 16   1  46.66667 NA    NA   NA   NA     1     2 70  50
#&gt; 17   1  55.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 18   1  55.55556 NA    NA   NA   NA     1     2 70  50
#&gt; 19   1  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 20   1  64.44444 NA    NA   NA   NA     1     2 70  50
#&gt; 21   1  72.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 22   1  73.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 23   1  73.33333 NA    NA   NA   NA     1     2 70  50
#&gt; 24   1  82.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 25   1  82.22222 NA    NA   NA   NA     1     2 70  50
#&gt; 26   1  91.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 27   1  91.11111 NA    NA   NA   NA     1     2 70  50
#&gt; 28   1 100.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 29   1 100.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 30   1 120.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 31   2   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 32   2   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 33   2   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 34   2   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 35   2   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 36   2  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 37   2  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 38   2  20.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 39   2  24.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 40   2  28.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 41   2  28.88889 NA    NA   NA   NA     1     2 70  50
#&gt; 42   2  36.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 43   2  37.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 44   2  37.77778 NA    NA   NA   NA     1     2 70  50
#&gt; 45   2  46.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 46   2  46.66667 NA    NA   NA   NA     1     2 70  50
#&gt; 47   2  55.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 48   2  55.55556 NA    NA   NA   NA     1     2 70  50
#&gt; 49   2  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 50   2  64.44444 NA    NA   NA   NA     1     2 70  50
#&gt; 51   2  72.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 52   2  73.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 53   2  73.33333 NA    NA   NA   NA     1     2 70  50
#&gt; 54   2  82.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 55   2  82.22222 NA    NA   NA   NA     1     2 70  50
#&gt; 56   2  91.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 57   2  91.11111 NA    NA   NA   NA     1     2 70  50
#&gt; 58   2 100.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 59   2 100.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 60   2 120.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 61   3   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 62   3   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 63   3   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 64   3   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 65   3   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 66   3  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 67   3  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 68   3  20.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 69   3  24.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 70   3  28.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 71   3  28.88889 NA    NA   NA   NA     1     2 70  50
#&gt; 72   3  36.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 73   3  37.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 74   3  37.77778 NA    NA   NA   NA     1     2 70  50
#&gt; 75   3  46.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 76   3  46.66667 NA    NA   NA   NA     1     2 70  50
#&gt; 77   3  55.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 78   3  55.55556 NA    NA   NA   NA     1     2 70  50
#&gt; 79   3  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 80   3  64.44444 NA    NA   NA   NA     1     2 70  50
#&gt; 81   3  72.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 82   3  73.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 83   3  73.33333 NA    NA   NA   NA     1     2 70  50
#&gt; 84   3  82.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 85   3  82.22222 NA    NA   NA   NA     1     2 70  50
#&gt; 86   3  91.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 87   3  91.11111 NA    NA   NA   NA     1     2 70  50
#&gt; 88   3 100.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 89   3 100.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 90   3 120.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 91   4   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 92   4   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 93   4   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 94   4   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 95   4   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 96   4  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 97   4  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 98   4  20.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 99   4  24.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 100  4  28.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 101  4  28.88889 NA    NA   NA   NA     2     2 60  45
#&gt; 102  4  36.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 103  4  37.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 104  4  37.77778 NA    NA   NA   NA     2     2 60  45
#&gt; 105  4  46.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 106  4  46.66667 NA    NA   NA   NA     2     2 60  45
#&gt; 107  4  55.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 108  4  55.55556 NA    NA   NA   NA     2     2 60  45
#&gt; 109  4  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 110  4  64.44444 NA    NA   NA   NA     2     2 60  45
#&gt; 111  4  72.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 112  4  73.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 113  4  73.33333 NA    NA   NA   NA     2     2 60  45
#&gt; 114  4  82.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 115  4  82.22222 NA    NA   NA   NA     2     2 60  45
#&gt; 116  4  91.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 117  4  91.11111 NA    NA   NA   NA     2     2 60  45
#&gt; 118  4 100.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 119  4 100.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 120  4 120.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 121  5   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 122  5   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 123  5   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 124  5   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 125  5   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 126  5  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 127  5  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 128  5  20.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 129  5  24.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 130  5  28.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 131  5  28.88889 NA    NA   NA   NA     2     2 60  45
#&gt; 132  5  36.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 133  5  37.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 134  5  37.77778 NA    NA   NA   NA     2     2 60  45
#&gt; 135  5  46.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 136  5  46.66667 NA    NA   NA   NA     2     2 60  45
#&gt; 137  5  55.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 138  5  55.55556 NA    NA   NA   NA     2     2 60  45
#&gt; 139  5  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 140  5  64.44444 NA    NA   NA   NA     2     2 60  45
#&gt; 141  5  72.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 142  5  73.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 143  5  73.33333 NA    NA   NA   NA     2     2 60  45
#&gt; 144  5  82.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 145  5  82.22222 NA    NA   NA   NA     2     2 60  45
#&gt; 146  5  91.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 147  5  91.11111 NA    NA   NA   NA     2     2 60  45
#&gt; 148  5 100.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 149  5 100.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 150  5 120.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 151  6   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 152  6   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 153  6   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 154  6   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 155  6   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 156  6  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 157  6  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 158  6  20.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 159  6  24.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 160  6  28.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 161  6  28.88889 NA    NA   NA   NA     2     2 60  45
#&gt; 162  6  36.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 163  6  37.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 164  6  37.77778 NA    NA   NA   NA     2     2 60  45
#&gt; 165  6  46.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 166  6  46.66667 NA    NA   NA   NA     2     2 60  45
#&gt; 167  6  55.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 168  6  55.55556 NA    NA   NA   NA     2     2 60  45
#&gt; 169  6  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 170  6  64.44444 NA    NA   NA   NA     2     2 60  45
#&gt; 171  6  72.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 172  6  73.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 173  6  73.33333 NA    NA   NA   NA     2     2 60  45
#&gt; 174  6  82.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 175  6  82.22222 NA    NA   NA   NA     2     2 60  45
#&gt; 176  6  91.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 177  6  91.11111 NA    NA   NA   NA     2     2 60  45
#&gt; 178  6 100.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 179  6 100.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 180  6 120.00000 NA    NA   NA   NA     2     2 60  45</div><div class='input'><span class='fu'>model_prediction</span>(<span class='kw'>design</span><span class='kw'>=</span><span class='no'>design_4</span>,<span class='kw'>DV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>dosing</span><span class='kw'>=</span><span class='no'>dosing_4</span>,<span class='kw'>model_num_points</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>,<span class='fl'>10</span>),
                 <span class='kw'>model_minxt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>,<span class='fl'>20</span>),<span class='kw'>model_maxxt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>100</span>))</div><div class='output co'>#&gt;     ID      Time DV IPRED PRED  AMT Group Model WT AGE
#&gt; 1    1   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 2    1   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 3    1   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 4    1   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 5    1   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 6    1  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 7    1  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 8    1  20.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 9    1  24.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 10   1  28.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 11   1  28.88889 NA    NA   NA   NA     1     2 70  50
#&gt; 12   1  36.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 13   1  37.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 14   1  37.77778 NA    NA   NA   NA     1     2 70  50
#&gt; 15   1  46.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 16   1  46.66667 NA    NA   NA   NA     1     2 70  50
#&gt; 17   1  55.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 18   1  55.55556 NA    NA   NA   NA     1     2 70  50
#&gt; 19   1  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 20   1  64.44444 NA    NA   NA   NA     1     2 70  50
#&gt; 21   1  72.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 22   1  73.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 23   1  73.33333 NA    NA   NA   NA     1     2 70  50
#&gt; 24   1  82.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 25   1  82.22222 NA    NA   NA   NA     1     2 70  50
#&gt; 26   1  91.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 27   1  91.11111 NA    NA   NA   NA     1     2 70  50
#&gt; 28   1 100.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 29   1 100.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 30   1 120.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 31   2   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 32   2   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 33   2   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 34   2   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 35   2   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 36   2  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 37   2  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 38   2  20.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 39   2  24.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 40   2  28.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 41   2  28.88889 NA    NA   NA   NA     1     2 70  50
#&gt; 42   2  36.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 43   2  37.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 44   2  37.77778 NA    NA   NA   NA     1     2 70  50
#&gt; 45   2  46.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 46   2  46.66667 NA    NA   NA   NA     1     2 70  50
#&gt; 47   2  55.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 48   2  55.55556 NA    NA   NA   NA     1     2 70  50
#&gt; 49   2  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 50   2  64.44444 NA    NA   NA   NA     1     2 70  50
#&gt; 51   2  72.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 52   2  73.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 53   2  73.33333 NA    NA   NA   NA     1     2 70  50
#&gt; 54   2  82.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 55   2  82.22222 NA    NA   NA   NA     1     2 70  50
#&gt; 56   2  91.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 57   2  91.11111 NA    NA   NA   NA     1     2 70  50
#&gt; 58   2 100.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 59   2 100.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 60   2 120.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 61   3   0.50000 NA    NA   NA 1000     1     1 70  50
#&gt; 62   3   0.50000 NA    NA   NA   NA     1     1 70  50
#&gt; 63   3   1.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 64   3   2.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 65   3   6.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 66   3  10.00000 NA    NA   NA   20     1     1 70  50
#&gt; 67   3  20.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 68   3  20.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 69   3  24.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 70   3  28.88889 NA    NA   NA   NA     1     1 70  50
#&gt; 71   3  28.88889 NA    NA   NA   NA     1     2 70  50
#&gt; 72   3  36.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 73   3  37.77778 NA    NA   NA   NA     1     1 70  50
#&gt; 74   3  37.77778 NA    NA   NA   NA     1     2 70  50
#&gt; 75   3  46.66667 NA    NA   NA   NA     1     1 70  50
#&gt; 76   3  46.66667 NA    NA   NA   NA     1     2 70  50
#&gt; 77   3  55.55556 NA    NA   NA   NA     1     1 70  50
#&gt; 78   3  55.55556 NA    NA   NA   NA     1     2 70  50
#&gt; 79   3  64.44444 NA    NA   NA   NA     1     1 70  50
#&gt; 80   3  64.44444 NA    NA   NA   NA     1     2 70  50
#&gt; 81   3  72.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 82   3  73.33333 NA    NA   NA   NA     1     1 70  50
#&gt; 83   3  73.33333 NA    NA   NA   NA     1     2 70  50
#&gt; 84   3  82.22222 NA    NA   NA   NA     1     1 70  50
#&gt; 85   3  82.22222 NA    NA   NA   NA     1     2 70  50
#&gt; 86   3  91.11111 NA    NA   NA   NA     1     1 70  50
#&gt; 87   3  91.11111 NA    NA   NA   NA     1     2 70  50
#&gt; 88   3 100.00000 NA    NA   NA   NA     1     1 70  50
#&gt; 89   3 100.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 90   3 120.00000 NA    NA   NA   NA     1     2 70  50
#&gt; 91   4   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 92   4   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 93   4   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 94   4   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 95   4   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 96   4  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 97   4  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 98   4  20.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 99   4  24.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 100  4  28.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 101  4  28.88889 NA    NA   NA   NA     2     2 60  45
#&gt; 102  4  36.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 103  4  37.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 104  4  37.77778 NA    NA   NA   NA     2     2 60  45
#&gt; 105  4  46.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 106  4  46.66667 NA    NA   NA   NA     2     2 60  45
#&gt; 107  4  55.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 108  4  55.55556 NA    NA   NA   NA     2     2 60  45
#&gt; 109  4  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 110  4  64.44444 NA    NA   NA   NA     2     2 60  45
#&gt; 111  4  72.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 112  4  73.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 113  4  73.33333 NA    NA   NA   NA     2     2 60  45
#&gt; 114  4  82.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 115  4  82.22222 NA    NA   NA   NA     2     2 60  45
#&gt; 116  4  91.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 117  4  91.11111 NA    NA   NA   NA     2     2 60  45
#&gt; 118  4 100.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 119  4 100.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 120  4 120.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 121  5   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 122  5   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 123  5   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 124  5   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 125  5   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 126  5  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 127  5  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 128  5  20.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 129  5  24.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 130  5  28.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 131  5  28.88889 NA    NA   NA   NA     2     2 60  45
#&gt; 132  5  36.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 133  5  37.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 134  5  37.77778 NA    NA   NA   NA     2     2 60  45
#&gt; 135  5  46.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 136  5  46.66667 NA    NA   NA   NA     2     2 60  45
#&gt; 137  5  55.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 138  5  55.55556 NA    NA   NA   NA     2     2 60  45
#&gt; 139  5  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 140  5  64.44444 NA    NA   NA   NA     2     2 60  45
#&gt; 141  5  72.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 142  5  73.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 143  5  73.33333 NA    NA   NA   NA     2     2 60  45
#&gt; 144  5  82.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 145  5  82.22222 NA    NA   NA   NA     2     2 60  45
#&gt; 146  5  91.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 147  5  91.11111 NA    NA   NA   NA     2     2 60  45
#&gt; 148  5 100.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 149  5 100.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 150  5 120.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 151  6   0.50000 NA    NA   NA 1000     2     1 60  45
#&gt; 152  6   0.50000 NA    NA   NA   NA     2     1 60  45
#&gt; 153  6   1.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 154  6   2.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 155  6   6.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 156  6  10.00000 NA    NA   NA   20     2     1 60  45
#&gt; 157  6  20.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 158  6  20.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 159  6  24.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 160  6  28.88889 NA    NA   NA   NA     2     1 60  45
#&gt; 161  6  28.88889 NA    NA   NA   NA     2     2 60  45
#&gt; 162  6  36.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 163  6  37.77778 NA    NA   NA   NA     2     1 60  45
#&gt; 164  6  37.77778 NA    NA   NA   NA     2     2 60  45
#&gt; 165  6  46.66667 NA    NA   NA   NA     2     1 60  45
#&gt; 166  6  46.66667 NA    NA   NA   NA     2     2 60  45
#&gt; 167  6  55.55556 NA    NA   NA   NA     2     1 60  45
#&gt; 168  6  55.55556 NA    NA   NA   NA     2     2 60  45
#&gt; 169  6  64.44444 NA    NA   NA   NA     2     1 60  45
#&gt; 170  6  64.44444 NA    NA   NA   NA     2     2 60  45
#&gt; 171  6  72.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 172  6  73.33333 NA    NA   NA   NA     2     1 60  45
#&gt; 173  6  73.33333 NA    NA   NA   NA     2     2 60  45
#&gt; 174  6  82.22222 NA    NA   NA   NA     2     1 60  45
#&gt; 175  6  82.22222 NA    NA   NA   NA     2     2 60  45
#&gt; 176  6  91.11111 NA    NA   NA   NA     2     1 60  45
#&gt; 177  6  91.11111 NA    NA   NA   NA     2     2 60  45
#&gt; 178  6 100.00000 NA    NA   NA   NA     2     1 60  45
#&gt; 179  6 100.00000 NA    NA   NA   NA     2     2 60  45
#&gt; 180  6 120.00000 NA    NA   NA   NA     2     2 60  45</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://katalog.uu.se/profile/?id=N4-631'>Andrew C. Hooker</a>, Marco Foracchia, <a href='https://katalog.uu.se/profile/?id=N9-467'>Sebastian Ueckert</a>, <a href='https://scholar.google.se/citations?user=4CgHwr0AAAAJ&hl=en'>Joakim Nyberg</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


