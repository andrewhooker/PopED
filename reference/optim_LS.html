<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimize a function using a line search algorithm. — optim_LS • PopED</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimize a function using a line search algorithm. — optim_LS"><meta name="description" content="optim_LS performs sequential grid search optimization of an arbitrary function with respect
to each of the parameters to be optimized over.
The function works for both discrete and continuous optimization parameters
and allows for box-constraints (by using the upper and lower function arguments) or sets of allowed values (by using the
allowed_values function argument) for all parameters, or on a parameter per parameter basis."><meta property="og:description" content="optim_LS performs sequential grid search optimization of an arbitrary function with respect
to each of the parameters to be optimized over.
The function works for both discrete and continuous optimization parameters
and allows for box-constraints (by using the upper and lower function arguments) or sets of allowed values (by using the
allowed_values function argument) for all parameters, or on a parameter per parameter basis."><meta property="og:image" content="https://andrewhooker.github.io/PopED/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PopED</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/intro-poped.html">Introduction</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/model_def_other_pkgs.html">Defining models for PopED using R based PKPD simulators</a></li>
    <li><a class="dropdown-item" href="../articles/handling_LOQ.html">Optimal design with LOQ data in PopED</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrewhooker/PopED" aria-label="Go to github for PopED"><span class="fa fab fa-github fa-lg"></span> Source</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimize a function using a line search algorithm.</h1>
      <small class="dont-index">Source: <a href="https://github.com/andrewhooker/PopED/blob/master/R/optim_LS.R" class="external-link"><code>R/optim_LS.R</code></a></small>
      <div class="d-none name"><code>optim_LS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>optim_LS</code> performs sequential grid search optimization of an arbitrary function with respect
to each of the parameters to be optimized over.
The function works for both discrete and continuous optimization parameters
and allows for box-constraints (by using the upper and lower function arguments) or sets of allowed values (by using the
allowed_values function argument) for all parameters, or on a parameter per parameter basis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optim_LS</span><span class="op">(</span></span>
<span>  <span class="va">par</span>,</span>
<span>  <span class="va">fn</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  allowed_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line_length <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  maximize <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  parallel_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mrgsolve_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1e+07</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  allow_replicates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  replicates_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ofv_initial <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  closed_bounds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p>A vector of initial values for the parameters to be optimized over.</p></dd>


<dt id="arg-fn">fn<a class="anchor" aria-label="anchor" href="#arg-fn"></a></dt>
<dd><p>A function to be minimized (or maximized),
with first argument the vector of parameters over which minimization is to take place.
It should return a scalar result.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Lower bounds on the parameters. A vector.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Upper bounds on the parameters. A vector.</p></dd>


<dt id="arg-allowed-values">allowed_values<a class="anchor" aria-label="anchor" href="#arg-allowed-values"></a></dt>
<dd><p>A list containing allowed values for each parameter <code>list(par1=c(2,3,4,5,6),par2=c(5,6,7,8))</code>.
A vector containing allowed values for all parameters is also allowed <code>c(2,3,4,5,6)</code>.</p></dd>


<dt id="arg-line-length">line_length<a class="anchor" aria-label="anchor" href="#arg-line-length"></a></dt>
<dd><p>The number of different parameter values per parameter to evaluate.  The values are
selected as an evenly spaced grid between the upper and lower bounds.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>Should the algorithm output results intermittently.</p></dd>


<dt id="arg-maximize">maximize<a class="anchor" aria-label="anchor" href="#arg-maximize"></a></dt>
<dd><p>Should the function be maximized?  Default is to minimize.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Should we use parallel computations?</p></dd>


<dt id="arg-parallel-type">parallel_type<a class="anchor" aria-label="anchor" href="#arg-parallel-type"></a></dt>
<dd><p>Which type of parallelization should be used?
Can be "snow" or "multicore".  "snow"  works on Linux-like systems &amp; Windows. "multicore" works only on
Linux-like systems.  By default this is chosen for you depending on your operating system.
See <code><a href="start_parallel.html">start_parallel</a></code>.</p></dd>


<dt id="arg-num-cores">num_cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>The number of cores to use in the parallelization.  By default  is set to the number
 output from
<code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>.
See <code><a href="start_parallel.html">start_parallel</a></code>.</p></dd>


<dt id="arg-mrgsolve-model">mrgsolve_model<a class="anchor" aria-label="anchor" href="#arg-mrgsolve-model"></a></dt>
<dd><p>If the computations require a mrgsolve model and you
are using the "snow" method then you need to specify the name of the model
object created by <code>mread</code> or <code>mcode</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>The random seed to use in the algorithm,</p></dd>


<dt id="arg-allow-replicates">allow_replicates<a class="anchor" aria-label="anchor" href="#arg-allow-replicates"></a></dt>
<dd><p>Should the algorithm allow parameters to have the same value?</p></dd>


<dt id="arg-replicates-index">replicates_index<a class="anchor" aria-label="anchor" href="#arg-replicates-index"></a></dt>
<dd><p>A vector, the same length as the parameters.
If two values are the same in this vector then the parameters may not assume the same value in the optimization.</p></dd>


<dt id="arg-ofv-initial">ofv_initial<a class="anchor" aria-label="anchor" href="#arg-ofv-initial"></a></dt>
<dd><p>An initial objective function value (OFV).  If not NULL then the initial design is not evaluated
and the OFV value is assumed to be this number.</p></dd>


<dt id="arg-closed-bounds">closed_bounds<a class="anchor" aria-label="anchor" href="#arg-closed-bounds"></a></dt>
<dd><p>Are the upper and lower limits open (boundaries not allowed) or closed (boundaries allowed) bounds?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>fn</code> and <code>start_parallel</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ol><li><p>M. Foracchia, A.C. Hooker, P. Vicini and A. Ruggeri, "PopED, a software fir optimal
experimental design in population kinetics", Computer Methods and Programs in Biomedicine, 74, 2004.</p></li>
<li><p>J. Nyberg, S. Ueckert, E.A. Stroemberg, S. Hennig, M.O. Karlsson and A.C. Hooker, "PopED: An extended,
parallelized, nonlinear mixed effects models optimal design tool",
Computer Methods and Programs in Biomedicine, 108, 2012.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Optimize:
<code><a href="Doptim.html">Doptim</a>()</code>,
<code><a href="LEDoptim.html">LEDoptim</a>()</code>,
<code><a href="RS_opt.html">RS_opt</a>()</code>,
<code><a href="a_line_search.html">a_line_search</a>()</code>,
<code><a href="bfgsb_min.html">bfgsb_min</a>()</code>,
<code><a href="calc_autofocus.html">calc_autofocus</a>()</code>,
<code><a href="calc_ofv_and_grad.html">calc_ofv_and_grad</a>()</code>,
<code><a href="mfea.html">mfea</a>()</code>,
<code><a href="optim_ARS.html">optim_ARS</a>()</code>,
<code><a href="poped_optim.html">poped_optim</a>()</code>,
<code><a href="poped_optim_1.html">poped_optim_1</a>()</code>,
<code><a href="poped_optim_2.html">poped_optim_2</a>()</code>,
<code><a href="poped_optim_3.html">poped_optim_3</a>()</code>,
<code><a href="poped_optimize.html">poped_optimize</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># "wild" function </span></span></span>
<span class="r-in"><span><span class="va">fw</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">0.3</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.00001</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span><span class="va">x</span><span class="op">+</span><span class="fl">80</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Global minimum of 67.47 at about -15.81515</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fw_min</span> <span class="op">&lt;-</span> <span class="fu">fw</span><span class="op">(</span><span class="op">-</span><span class="fl">15.81515</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 67.46773</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>  </span></span>
<span class="r-in"><span>  <span class="co">#plot of the function</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fw</span>, <span class="op">-</span><span class="fl">50</span>, <span class="fl">50</span>, n <span class="op">=</span> <span class="fl">10000</span>, main <span class="op">=</span> <span class="st">"Minimizing 'wild function'"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Known minimum</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15.81515</span>, <span class="va">fw_min</span>, pch <span class="op">=</span> <span class="fl">21</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># optimization with fewer function evaluations </span></span></span>
<span class="r-in"><span><span class="co"># compared to SANN: see examples in '?optim'</span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fl">50</span>, <span class="va">fw</span>,lower <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, upper<span class="op">=</span><span class="fl">50</span>, line_length <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial parameters: 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial OFV: 159.0012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 50 to -15.8166 ; OFV = 67.485 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Elapsed time: 0.033 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Final OFV =  67.48502 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Parameters: -15.81658 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fw</span>, <span class="op">-</span><span class="fl">20</span>, <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">10000</span>, main <span class="op">=</span> <span class="st">"Minimizing 'wild function'"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Known minimum</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15.81515</span>, <span class="va">fw_min</span>, pch <span class="op">=</span> <span class="fl">21</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#plot of the optimization</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">par</span>, <span class="va">res1</span><span class="op">$</span><span class="va">ofv</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"green"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Upper and lower bounds and line_length should be considered carefully</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fl">50</span>, <span class="va">fw</span>, lower<span class="op">=</span><span class="op">-</span><span class="cn">Inf</span>,upper<span class="op">=</span><span class="cn">Inf</span>,line_length <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial parameters: 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial OFV: 159.0012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 50 to -5.0055 ; OFV = 69.8766 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Elapsed time: 0.038 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Final OFV =  69.87659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Parameters: -5.005501 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Only integer values allowed</span></span></span>
<span class="r-in"><span><span class="va">res_int</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fl">50</span>, <span class="va">fw</span>, allowed_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>,<span class="fl">50</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial parameters: 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial OFV: 159.0012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 50 to -17 ; OFV = 68.5368 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Elapsed time: 0.001 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Final OFV =  68.53679 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Parameters: -17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Rosenbrock Banana function</span></span></span>
<span class="r-in"><span><span class="co"># f(x, y) = (a-x)^2 + b*(y-x^2)^2</span></span></span>
<span class="r-in"><span><span class="co"># global minimum at (x, y)=(a, a^2), where f(x, y)=0. </span></span></span>
<span class="r-in"><span><span class="co"># Usually a = 1 and b = 100 so x=1 and y=1</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">fr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">a</span><span class="op">=</span><span class="fl">1</span>,<span class="va">b</span><span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span>   </span></span>
<span class="r-in"><span>    <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span><span class="op">*</span><span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">a</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">fr</span>,lower <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, upper <span class="op">=</span> <span class="fl">5</span>, line_length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># plot the surface</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">50</span>, length<span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span></span></span>
<span class="r-in"><span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>,<span class="fl">1</span>,<span class="va">fr</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, theta <span class="op">=</span> <span class="fl">30</span>, phi <span class="op">=</span> <span class="fl">30</span>, expand <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, ticktype<span class="op">=</span><span class="st">"detailed"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">res</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/trans3d.html" class="external-link">trans3d</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, pmat <span class="op">=</span> <span class="va">res</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">16</span>,cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/trans3d.html" class="external-link">trans3d</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">res3</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">res3</span><span class="op">$</span><span class="va">ofv</span>, pmat <span class="op">=</span> <span class="va">res</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span>, pch <span class="op">=</span> <span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># box constraints</span></span></span>
<span class="r-in"><span><span class="va">flb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">p</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">p</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 25-dimensional box constrained</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">25</span><span class="op">)</span>, <span class="va">flb</span>,lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">25</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">25</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"L-BFGS-B"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">res_box</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">25</span><span class="op">)</span>, <span class="va">flb</span>,</span></span>
<span class="r-in"><span>                    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">25</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    line_length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial parameters: 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial OFV: 3460 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 3370.22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 3280.43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 3190.65 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 4 ; OFV = 3146.65 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 3056.87 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 2967.09 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 2789.85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 2700.07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 2610.29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 2520.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 2397.28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.14414 ; OFV = 2307.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 2184.28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 2026.82 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 1869.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 1711.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 1589.68 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 1432.22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 1304.22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 1146.77 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 984.533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 827.077 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 699.077 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2.10811 ; OFV = 610.183 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 3 to 2 ; OFV = 446.962 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Elapsed time: 0.148 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Final OFV =  446.9622 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Parameters: 2 2.144144 2 2.144144 2 2 2.144144 2 2.144144 2 2.144144 2 2.144144 2 2 2.144144 2 2.144144 2 2.144144 2 2 2 2.108108 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one-dimensional function</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="va">f</span>,lower<span class="op">=</span><span class="op">-</span><span class="fl">20</span>, upper<span class="op">=</span><span class="fl">20</span>, line_length <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">f</span>, <span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">res5</span><span class="op">$</span><span class="va">par</span>, lty <span class="op">=</span> <span class="fl">4</span>,col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one-dimensional function</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># -10 &lt; x &lt; 10</span></span></span>
<span class="r-in"><span><span class="va">res_max</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fl">0</span>,<span class="va">f</span>,lower<span class="op">=</span><span class="op">-</span><span class="fl">10</span>, upper<span class="op">=</span><span class="fl">10</span>,maximize<span class="op">=</span><span class="cn">TRUE</span>,line_length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial parameters: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Initial OFV: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Searching parameter 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Changed from 0 to 6.55656 ; OFV = 47.7052 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Elapsed time: 0.002 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Final OFV =  47.7052 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Parameters: 6.556557 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">res_min</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fl">0</span>,<span class="va">f</span>,lower<span class="op">=</span><span class="op">-</span><span class="fl">10</span>, upper<span class="op">=</span><span class="fl">10</span>, line_length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">f</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">res_min</span><span class="op">$</span><span class="va">par</span>, lty <span class="op">=</span> <span class="fl">4</span>,col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">res_max</span><span class="op">$</span><span class="va">par</span>, lty <span class="op">=</span> <span class="fl">4</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># two-dimensional Rastrigin function</span></span></span>
<span class="r-in"><span><span class="co">#It has a global minimum at f(x) = f(0) = 0.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">Rastrigin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fl">20</span> <span class="op">+</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="fl">5.12</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">Rastrigin</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">res6</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   lower<span class="op">=</span><span class="op">-</span><span class="fl">5.12</span>, upper<span class="op">=</span><span class="fl">5.12</span>, line_length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># color scale</span></span></span>
<span class="r-in"><span>  <span class="va">nrz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ncz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">jet.colors</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00007F"</span>, <span class="st">"blue"</span>, <span class="st">"#007FFF"</span>, <span class="st">"cyan"</span>,</span></span>
<span class="r-in"><span>                       <span class="st">"#7FFF7F"</span>, <span class="st">"yellow"</span>, <span class="st">"#FF7F00"</span>, <span class="st">"red"</span>, <span class="st">"#7F0000"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Generate the desired number of colors from this palette</span></span></span>
<span class="r-in"><span>  <span class="va">nbcol</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="va">color</span> <span class="op">&lt;-</span> <span class="fu">jet.colors</span><span class="op">(</span><span class="va">nbcol</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the z-value at the facet centres</span></span></span>
<span class="r-in"><span>  <span class="va">zfacet</span> <span class="op">&lt;-</span> <span class="va">z</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">z</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="va">ncz</span><span class="op">]</span> <span class="op">+</span> <span class="va">z</span><span class="op">[</span><span class="op">-</span><span class="va">nrz</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">z</span><span class="op">[</span><span class="op">-</span><span class="va">nrz</span>, <span class="op">-</span><span class="va">ncz</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># Recode facet z-values into color indices</span></span></span>
<span class="r-in"><span>  <span class="va">facetcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">zfacet</span>, <span class="va">nbcol</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">z</span>, col <span class="op">=</span> <span class="va">color</span><span class="op">[</span><span class="va">facetcol</span><span class="op">]</span>, phi <span class="op">=</span> <span class="fl">30</span>, theta <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">z</span>, color.palette <span class="op">=</span> <span class="va">jet.colors</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Parallel computation  </span></span></span>
<span class="r-in"><span><span class="co">## works better when each evaluation takes longer</span></span></span>
<span class="r-in"><span><span class="co">## here we have added extra time to the computations</span></span></span>
<span class="r-in"><span><span class="co">## just to show that it works</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">res7</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>; <span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>                   lower<span class="op">=</span><span class="op">-</span><span class="fl">5.12</span>, upper<span class="op">=</span><span class="fl">5.12</span>, line_length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res8</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>; <span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>                   lower<span class="op">=</span><span class="op">-</span><span class="fl">5.12</span>, upper<span class="op">=</span><span class="fl">5.12</span>, line_length <span class="op">=</span> <span class="fl">200</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res9</span> <span class="op">&lt;-</span> <span class="fu">optim_LS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>; <span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>                   lower<span class="op">=</span><span class="op">-</span><span class="fl">5.12</span>, upper<span class="op">=</span><span class="fl">5.12</span>, line_length <span class="op">=</span> <span class="fl">200</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                   parallel_type <span class="op">=</span> <span class="st">"snow"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://katalog.uu.se/profile/?id=N4-631" class="external-link">Andrew C. Hooker</a>, Marco Foracchia, <a href="https://katalog.uu.se/profile/?id=N9-467" class="external-link">Sebastian Ueckert</a>, <a href="https://scholar.google.se/citations?user=4CgHwr0AAAAJ&amp;hl=en" class="external-link">Joakim Nyberg</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

