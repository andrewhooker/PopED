<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PopED">
<title>Defining models for PopED using R based PKPD simulators â€¢ PopED</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Defining models for PopED using R based PKPD simulators">
<meta property="og:description" content="PopED">
<meta property="og:image" content="https://andrewhooker.github.io/PopED/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PopED</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/intro-poped.html">Introduction</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples.html">Examples</a>
    <a class="dropdown-item" href="../articles/model_def_other_pkgs.html">Defining models for PopED using R based PKPD simulators</a>
    <a class="dropdown-item" href="../articles/handling_LOQ.html">Optimal design with LOQ data in PopED</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/andrewhooker/PopED">
    <span class="fab fa fab fa-github fa-lg"></span>
     
    Source
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="model_def_other_pkgs_files/kePrint-0.0.1/kePrint.js"></script><link href="model_def_other_pkgs_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Defining models for PopED using R based PKPD simulators</h1>
                        <h4 data-toc-skip class="author">Andrew Hooker,
Ron Keizer and Vijay Ivaturi</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andrewhooker/PopED/blob/HEAD/vignettes/articles/model_def_other_pkgs.Rmd" class="external-link"><code>vignettes/articles/model_def_other_pkgs.Rmd</code></a></small>
      <div class="d-none name"><code>model_def_other_pkgs.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is a simple example on how to couple PopED with external R based
PKPD simulation tools. Typically, these tools might be R packages that
can simulate from ordinary differential equation (ODE) based models. In
this document you will see how to couple PopED to models, defined with
ODEs, implemented using:</p>
<ul>
<li>deSolve (with native R ODE models)</li>
<li>deSolve (with compiled C ODE models)</li>
<li>deSolve (with compiled C++ ODE models using Rcpp)</li>
<li>PKPDsim</li>
<li>mrgsolve</li>
<li>rxode2</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrewhooker.github.io/PopED/">PopED</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/InsightRX/PKPDsim" class="external-link">PKPDsim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/metrumresearchgroup/mrgsolve" class="external-link">mrgsolve</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'mrgsolve'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/" class="external-link">deSolve</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rcpp.org" class="external-link">Rcpp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/" class="external-link">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 2.0.14 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span></code></pre></div>
<!-- For the future we will also show how to use -->
<!-- * PKPDmodels -->
<!-- * dMod -->
</div>
<div class="section level2">
<h2 id="the-model">The model<a class="anchor" aria-label="anchor" href="#the-model"></a>
</h2>
<p>We will use a one-compartment with linear absorption population
pharmacokinetic (PK) model as an example (see below).</p>
<!-- Figure \@ref(fig:1-comp-lin-abs)). -->
<!-- ```{r 1-comp-lin-abs, echo=FALSE, fig.cap="Graphical representation of a one-compartment model with linear absorption.",fig.align='center'} -->
<!-- knitr::include_graphics("model_def_other_pkgs_1-comp-lin-abs.png") -->
<!-- ``` -->
<p><img src="model_def_other_pkgs_img/model_def_other_pkgs_1-comp-lin-abs.png"></p>
<p>This model can be described with the following set of ODEs:</p>
<p><span class="math display">\[
  \begin{split}
  \frac{dA_{0}}{dt} &amp;=  - k_{a} \cdot A_{0}\\
  \frac{dA_{1}}{dt} &amp;=-(CL/V_1)\cdot A_1 + k_{a} \cdot A_{0} \\
  f(t) &amp;= A_1/V_1
  \end{split}
\]</span></p>
<p>All compartment amounts are assumed to be zero at time zero (<span class="math inline">\(\boldsymbol{A}[t=0]=0\)</span>). Inputs to the
system come in tablet form and are added to the amount in <span class="math inline">\(A_{0}\)</span> according to</p>
<p><span class="math display">\[
  \text{Input}(t,D,t_D) =
  \begin{cases}
   D, &amp;\text{if} \quad t = t_D \\
   0, &amp;\text{otherwise}
  \end{cases}
\]</span></p>
<p>Parameter values are defined as:</p>
<p><span class="math display">\[
  \begin{split}
    k_a &amp;= \theta_{k_a} \cdot e^{\eta_{k_a}} \\
    CL &amp;= \theta_{CL} \cdot e^{\eta_{CL}} \\
    V_1 &amp;= \theta_{V_1} \cdot e^{\eta_{V_1}}  \\
  \end{split}
\]</span> where elements of the between subject variability (BSV), <span class="math inline">\(\eta_{j}\)</span>, vary across individuals and
come from normal distributions with means of zero and variances of <span class="math inline">\(\omega^2_{j}\)</span>.</p>
<p>The residual unexplained variability (RUV) model has a proportional
and additive component</p>
<p><span class="math display">\[
  y = f(t) \cdot (1+\varepsilon_{prop}) + \varepsilon_{add}
\]</span></p>
<p>elements of <span class="math inline">\(\boldsymbol{\varepsilon}_{j}\)</span> vary accross
observations and come from normal distributions with means of zero and
variances of <span class="math inline">\(\sigma^2_{j}\)</span>.</p>
Parameter values are assumed to be the following:
<!-- those in Table  \@ref(tab:values).   -->
<table class="table table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:right;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(k_a\)</span>
</td>
<td style="text-align:right;">
0.2500
</td>
</tr>
<tr>
<td style="text-align:left;">
CL
</td>
<td style="text-align:right;">
3.7500
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(V_1\)</span>
</td>
<td style="text-align:right;">
72.8000
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\omega^2_{k_a}\)</span>
</td>
<td style="text-align:right;">
0.0900
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\omega^2_{CL}\)</span>
</td>
<td style="text-align:right;">
0.0625
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\omega^2_{V_1}\)</span>
</td>
<td style="text-align:right;">
0.0900
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^2_{prop}\)</span>
</td>
<td style="text-align:right;">
0.0400
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^2_{add}\)</span>
</td>
<td style="text-align:right;">
0.0025
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="model-implementation">Model implementation<a class="anchor" aria-label="anchor" href="#model-implementation"></a>
</h2>
<p>Below we implement this model using a number of different methods.
For the ODE solvers, if possible, we set the tuning parameters to be the
same values (<code>atol</code>, <code>rtol</code>, etc.).</p>
<div class="section level3">
<h3 id="analytic-solution">Analytic solution<a class="anchor" aria-label="anchor" href="#analytic-solution"></a>
</h3>
<p>First we implement an analytic solution to the model in a function
that could be used in <code>PopED</code>. Here we assume a single dose
or multiple dosing with a dose interval of <code>TAU</code> time units.
The named vector <code>parameters</code> defines the values of
<code>KA</code>, <code>CL</code>, <code>V</code>, <code>DOSE</code> and
<code>TAU</code> used to compute the value of <code>f</code> at each
time point in the vector <code>xt</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff_analytic</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>,<span class="va">xt</span>,<span class="va">parameters</span>,<span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>,<span class="op">{</span></span>
<span>    <span class="va">y</span><span class="op">=</span><span class="va">xt</span></span>
<span>    <span class="va">N</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">xt</span><span class="op">/</span><span class="va">TAU</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">f</span><span class="op">=</span><span class="op">(</span><span class="va">DOSE</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">KA</span><span class="op">/</span><span class="op">(</span><span class="va">KA</span> <span class="op">-</span> <span class="va">CL</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> </span>
<span>      <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">CL</span><span class="op">/</span><span class="va">V</span> <span class="op">*</span> <span class="op">(</span><span class="va">xt</span> <span class="op">-</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">TAU</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">N</span> <span class="op">*</span> <span class="va">CL</span><span class="op">/</span><span class="va">V</span> <span class="op">*</span> <span class="va">TAU</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">CL</span><span class="op">/</span><span class="va">V</span> <span class="op">*</span> <span class="va">TAU</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">KA</span> <span class="op">*</span> <span class="op">(</span><span class="va">xt</span> <span class="op">-</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">TAU</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">N</span> <span class="op">*</span> <span class="va">KA</span> <span class="op">*</span> <span class="va">TAU</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">KA</span> <span class="op">*</span> <span class="va">TAU</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> f<span class="op">=</span><span class="va">f</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ode-solution-using-desolve">ODE solution using deSolve<a class="anchor" aria-label="anchor" href="#ode-solution-using-desolve"></a>
</h3>
<p>The same model can be implemented using ODEs. Here the ODEs are
defined in deSolve:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PK_1_comp_oral_ode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Time</span>, <span class="va">State</span>, <span class="va">Pars</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">State</span>, <span class="va">Pars</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span>    </span>
<span>    <span class="va">dA1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">A1</span></span>
<span>    <span class="va">dA2</span> <span class="op">&lt;-</span> <span class="va">KA</span><span class="op">*</span><span class="va">A1</span> <span class="op">-</span> <span class="op">(</span><span class="va">CL</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">*</span><span class="va">A2</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dA1</span>, <span class="va">dA2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then, just as in the analytic solution, the named vector
<code>parameters</code> defines the values of <code>KA</code>,
<code>CL</code>, <code>V</code>, <code>DOSE</code> and <code>TAU</code>
used to compute the value of <code>f</code> at each time point in the
vector <code>xt</code>. The inputs to the system (dosing amounts and
times) need to be added as <code>events</code> in the deSolve ODE solver
called <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">deSolve::ode()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff_ode_desolve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>, <span class="va">xt</span>, <span class="va">parameters</span>, <span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>,<span class="op">{</span></span>
<span>    <span class="va">A_ini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A1<span class="op">=</span><span class="fl">0</span>, A2<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#Set up time points for the ODE</span></span>
<span>    <span class="va">times_xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">times_xt</span><span class="op">)</span> <span class="co">## add extra time for start of the experiment</span></span>
<span>    <span class="va">dose_times</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span>,by<span class="op">=</span><span class="va">TAU</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">times</span>,<span class="va">dose_times</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> </span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="co"># remove duplicates</span></span>
<span>    </span>
<span>    <span class="va">eventdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span><span class="op">)</span>, </span>
<span>                           time <span class="op">=</span> <span class="va">dose_times</span>,</span>
<span>                           value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"add"</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">deSolve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span><span class="va">A_ini</span>, <span class="va">times</span>, <span class="va">PK_1_comp_oral_ode</span>, <span class="va">parameters</span>, </span>
<span>                        events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eventdat</span><span class="op">)</span>,</span>
<span>                        atol<span class="op">=</span><span class="fl">1e-8</span>, rtol<span class="op">=</span><span class="fl">1e-8</span>,maxsteps<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># grab timepoint values</span></span>
<span>    <span class="va">out</span> <span class="op">=</span> <span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">times_xt</span>,<span class="va">out</span><span class="op">[</span>,<span class="st">"time"</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">f</span> <span class="op">=</span> <span class="va">out</span><span class="op">[</span>,<span class="st">"A2"</span><span class="op">]</span><span class="op">/</span><span class="va">V</span></span>
<span>    </span>
<span>    <span class="va">f</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="co"># must be a column matrix </span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">f</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ode-solution-using-desolve-and-compiled-c-code">ODE solution using deSolve and compiled C code<a class="anchor" aria-label="anchor" href="#ode-solution-using-desolve-and-compiled-c-code"></a>
</h3>
<p>We can use compiled C code with deSolve to speed up computing
solutions to the ODEs. The C code is written in a separate file is that
needs to be compiled and looks like this:</p>
<pre><code>/* file one_comp_oral_CL.c */
#include &lt;R.h&gt;
static double parms[3];
#define CL parms[0]
#define V parms[1]
#define KA parms[2]

/* initializer  */
void initmod(void (* odeparms)(int *, double *))
{
  int N=3;
  odeparms(&amp;N, parms);
}

/* Derivatives and 1 output variable */
void derivs (int *neq, double *t, double *y, double *ydot,
         double *yout, int *ip)
{
    
  if (ip[0] &lt;1) error("nout should be at least 1");
    
  ydot[0] = -KA*y[0];
  ydot[1] = KA*y[0] - CL/V*y[1];
  yout[0] = y[0]+y[1];
}

/* END file one_comp_oral_CL.c */</code></pre>
<p>This code is available as a file in the PopED distribution, and is
compiled with the following commands:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/one_comp_oral_CL.c"</span>, package<span class="op">=</span><span class="st">"PopED"</span><span class="op">)</span>,<span class="st">"./one_comp_oral_CL.c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">'R CMD SHLIB one_comp_oral_CL.c'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dynload.html" class="external-link">dyn.load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"one_comp_oral_CL"</span>, <span class="va">.Platform</span><span class="op">$</span><span class="va">dynlib.ext</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The function used to compute the value of <code>f</code> at each time
point in the vector <code>xt</code>, given the inputs to the system
(dosing amounts and times), needs to be changed slightly, updating the
arguments to <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">deSolve::ode()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff_ode_desolve_c</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>, <span class="va">xt</span>, <span class="va">parameters</span>, <span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>,<span class="op">{</span></span>
<span>    <span class="va">A_ini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A1<span class="op">=</span><span class="fl">0</span>, A2<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#Set up time points for the ODE</span></span>
<span>    <span class="va">times_xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">times_xt</span><span class="op">)</span> <span class="co">## add extra time for the start of the experiment</span></span>
<span>    <span class="va">dose_times</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span>,by<span class="op">=</span><span class="va">TAU</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">times</span>,<span class="va">dose_times</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> </span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="co"># remove duplicates</span></span>
<span>    </span>
<span>    <span class="va">eventdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span><span class="op">)</span>, </span>
<span>                           time <span class="op">=</span> <span class="va">dose_times</span>,</span>
<span>                           value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"add"</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">deSolve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span><span class="va">A_ini</span>, <span class="va">times</span>, func <span class="op">=</span> <span class="st">"derivs"</span>, </span>
<span>                        parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CL</span>,<span class="va">V</span>,<span class="va">KA</span><span class="op">)</span>, </span>
<span>                        dllname <span class="op">=</span> <span class="st">"one_comp_oral_CL"</span>,</span>
<span>                        initfunc <span class="op">=</span> <span class="st">"initmod"</span>, nout <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        outnames <span class="op">=</span> <span class="st">"Sum"</span>,</span>
<span>                        events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eventdat</span><span class="op">)</span>,</span>
<span>                        atol<span class="op">=</span><span class="fl">1e-8</span>, rtol<span class="op">=</span><span class="fl">1e-8</span>,maxsteps<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># grab timepoint values</span></span>
<span>    <span class="va">out</span> <span class="op">=</span> <span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">times_xt</span>,<span class="va">out</span><span class="op">[</span>,<span class="st">"time"</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">f</span> <span class="op">=</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"A2"</span><span class="op">]</span><span class="op">/</span><span class="va">V</span></span>
<span>    </span>
<span>    <span class="va">f</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="co"># must be a column matrix </span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">f</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ode-solution-using-desolve-and-compiled-c-code-via-rcpp">ODE solution using deSolve and compiled C++ code (via Rcpp)<a class="anchor" aria-label="anchor" href="#ode-solution-using-desolve-and-compiled-c-code-via-rcpp"></a>
</h3>
<p>Here we define the ODE system using inline C++ code that is compiled
via Rcpp</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Rcpp/man/cppFunction.html" class="external-link">cppFunction</a></span><span class="op">(</span><span class="st">'List one_comp_oral_rcpp(double Time, NumericVector A, NumericVector Pars) {</span></span>
<span><span class="st">int n = A.size();</span></span>
<span><span class="st">NumericVector dA(n);</span></span>
<span><span class="st"></span></span>
<span><span class="st">double CL = Pars[0];</span></span>
<span><span class="st">double V = Pars[1];</span></span>
<span><span class="st">double KA = Pars[2];</span></span>
<span><span class="st"></span></span>
<span><span class="st">dA[0] = -KA*A[0];</span></span>
<span><span class="st">dA[1] = KA*A[0] - (CL/V)*A[1];</span></span>
<span><span class="st">return List::create(dA);</span></span>
<span><span class="st">}'</span><span class="op">)</span></span></code></pre></div>
<p>Again, the arguments to <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">deSolve::ode()</a></code> need to be
updated:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff_ode_desolve_rcpp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>, <span class="va">xt</span>, <span class="va">p</span>, <span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">A_ini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A1<span class="op">=</span><span class="fl">0</span>, A2<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#Set up time points for the ODE</span></span>
<span>    <span class="va">times_xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">times_xt</span><span class="op">)</span> <span class="co">## add extra time for start of integration</span></span>
<span>    <span class="va">dose_times</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span>,by<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"TAU"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">times</span>,<span class="va">dose_times</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> </span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="co"># remove duplicates</span></span>
<span>    </span>
<span>    <span class="va">eventdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span><span class="op">)</span>, </span>
<span>                           time <span class="op">=</span> <span class="va">dose_times</span>,</span>
<span>                           value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">[[</span><span class="st">"DOSE"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"add"</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">deSolve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span><span class="va">A_ini</span>, <span class="va">times</span>, </span>
<span>                        <span class="va">one_comp_oral_rcpp</span>, </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CL<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"CL"</span><span class="op">]</span><span class="op">]</span>,V<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span>, KA<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"KA"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                        events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eventdat</span><span class="op">)</span>,</span>
<span>                        atol<span class="op">=</span><span class="fl">1e-8</span>, rtol<span class="op">=</span><span class="fl">1e-8</span>,maxsteps<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="co"># grab timepoint values for central comp</span></span>
<span>    <span class="va">f</span> <span class="op">=</span> <span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">times_xt</span>,<span class="va">out</span><span class="op">[</span>,<span class="st">"time"</span><span class="op">]</span><span class="op">)</span>,<span class="st">"A2"</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">/</span><span class="va">p</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">f</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ode-solution-using-pkpdsim">ODE solution using PKPDsim<a class="anchor" aria-label="anchor" href="#ode-solution-using-pkpdsim"></a>
</h3>
<p>We can use PKPDsim to describe this set of ODEs. We then adjust the
function used to compute the value of <code>f</code> at each time point
in the vector <code>xt</code>, given the inputs to the system (dosing
amounts and times), using the ODE solver
<code><a href="https://insightrx.github.io/PKPDsim/reference/sim_core.html" class="external-link">PKPDsim::sim_core()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pk1cmtoral</span> <span class="op">&lt;-</span> <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/new_ode_model.html" class="external-link">new_ode_model</a></span><span class="op">(</span><span class="st">"pk_1cmt_oral"</span><span class="op">)</span> <span class="co"># take from library</span></span>
<span><span class="va">ff_ode_pkpdsim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>, <span class="va">xt</span>, <span class="va">p</span>, <span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co">#Set up time points for the ODE</span></span>
<span>    <span class="va">times_xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span>  </span>
<span>    <span class="va">dose_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span>,by<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"TAU"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">times_xt</span>,<span class="va">dose_times</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">N</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dose_times</span><span class="op">)</span></span>
<span>    <span class="va">regimen</span> <span class="op">=</span> <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/new_regimen.html" class="external-link">new_regimen</a></span><span class="op">(</span>amt<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"DOSE"</span><span class="op">]</span><span class="op">]</span>,n<span class="op">=</span><span class="va">N</span>,interval<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"TAU"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/sim.html" class="external-link">sim</a></span><span class="op">(</span></span>
<span>      ode <span class="op">=</span> <span class="va">pk1cmtoral</span>, </span>
<span>      parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CL<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"CL"</span><span class="op">]</span><span class="op">]</span>,V<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span>,KA<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"KA"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, </span>
<span>      regimen <span class="op">=</span> <span class="va">regimen</span>,</span>
<span>      only_obs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      t_obs <span class="op">=</span> <span class="va">times</span>,</span>
<span>      checks <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      return_design <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/sim_core.html" class="external-link">sim_core</a></span><span class="op">(</span>sim_object <span class="op">=</span> <span class="va">design</span>, ode <span class="op">=</span> <span class="va">pk1cmtoral</span><span class="op">)</span></span>
<span>    <span class="va">f</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">m_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">times_xt</span>,digits <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,<span class="va">tmp</span><span class="op">[</span>,<span class="st">"t"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">m_tmp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"can't find time points in solution\n"</span>, </span>
<span>           <span class="st">"try changing the digits argument in the match function"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> </span>
<span>    </span>
<span>    <span class="va">f</span> <span class="op">&lt;-</span> <span class="va">f</span><span class="op">[</span><span class="va">m_tmp</span><span class="op">]</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">f</span>, poped.db <span class="op">=</span> <span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ode-solution-using-mrgsolve">ODE solution using mrgsolve<a class="anchor" aria-label="anchor" href="#ode-solution-using-mrgsolve"></a>
</h3>
<p>We can also use mrgsolve to describe this set of ODEs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">code</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">$PARAM CL=3.75, V=72.8, KA=0.25</span></span>
<span><span class="st">$CMT DEPOT CENT</span></span>
<span><span class="st">$ODE</span></span>
<span><span class="st">dxdt_DEPOT = -KA*DEPOT;</span></span>
<span><span class="st">dxdt_CENT = KA*DEPOT - (CL/V)*CENT;</span></span>
<span><span class="st">$TABLE double CP  = CENT/V;</span></span>
<span><span class="st">$CAPTURE CP</span></span>
<span><span class="st">'</span></span></code></pre></div>
<p>We then compile and load the model with <code>mcode</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moda</span> <span class="op">&lt;-</span> <span class="fu">mrgsolve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mrgsolve/man/mcode.html" class="external-link">mcode</a></span><span class="op">(</span><span class="st">"optim"</span>, <span class="va">code</span>, atol<span class="op">=</span><span class="fl">1e-8</span>, rtol<span class="op">=</span><span class="fl">1e-8</span>,maxsteps<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Building optim ... done.</span></span></code></pre></div>
<p>Finally, we adjust the function used to compute the value of
<code>f</code> at each time point in the vector <code>xt</code>, given
the inputs to the system (dosing amounts and times), using the ODE
solver <code><a href="https://rdrr.io/pkg/mrgsolve/man/mrgsim_q.html" class="external-link">mrgsolve::mrgsim_q()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff_ode_mrg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>, <span class="va">xt</span>, <span class="va">p</span>, <span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">times_xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span>  </span>
<span>  <span class="va">dose_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span>,by<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"TAU"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">times_xt</span>,<span class="va">dose_times</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">is.dose</span> <span class="op">&lt;-</span> <span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">dose_times</span></span>
<span>  </span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      time <span class="op">=</span> <span class="va">time</span>,</span>
<span>                      amt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">is.dose</span>,<span class="va">p</span><span class="op">[[</span><span class="st">"DOSE"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                      cmt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">is.dose</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                      evid <span class="op">=</span> <span class="va">cmt</span>,</span>
<span>                      CL <span class="op">=</span> <span class="va">p</span><span class="op">[[</span><span class="st">"CL"</span><span class="op">]</span><span class="op">]</span>, V <span class="op">=</span> <span class="va">p</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span>, KA <span class="op">=</span> <span class="va">p</span><span class="op">[[</span><span class="st">"KA"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">mrgsolve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mrgsolve/man/mrgsim_q.html" class="external-link">mrgsim_q</a></span><span class="op">(</span><span class="va">moda</span>, data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span>  <span class="va">out</span><span class="op">$</span><span class="va">CP</span></span>
<span>  </span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="va">f</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">times_xt</span>,<span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">f</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ode-solution-using-rxode2">ODE solution using rxode2<a class="anchor" aria-label="anchor" href="#ode-solution-using-rxode2"></a>
</h3>
<p>We can use rxode2 to describe this set of ODEs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modrx</span> <span class="op">&lt;-</span> <span class="fu">rxode2</span><span class="fu">::</span><span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxode2.html" class="external-link">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">DEPOT</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">DEPOT</span>;</span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">CENT</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">DEPOT</span> <span class="op">-</span> <span class="op">(</span><span class="va">CL</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">*</span><span class="va">CENT</span>;</span>
<span>  <span class="va">CP</span><span class="op">=</span><span class="va">CENT</span><span class="op">/</span><span class="va">V</span>;</span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; using C compiler: â€˜gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0â€™</span></span></code></pre></div>
<p>We adjust the function used to compute the value of <code>f</code> at
each time point in the vector <code>xt</code>, given the inputs to the
system (dosing amounts and times), using the ODE solver
<code><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxode2::rxSolve()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff_ode_rx</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>, <span class="va">xt</span>, <span class="va">p</span>, <span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">times_xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/et.html" class="external-link">et</a></span><span class="op">(</span><span class="fl">0</span>,amt<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"DOSE"</span><span class="op">]</span><span class="op">]</span>, ii<span class="op">=</span><span class="va">p</span><span class="op">[[</span><span class="st">"TAU"</span><span class="op">]</span><span class="op">]</span>, until<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/et.html" class="external-link">et</a></span><span class="op">(</span><span class="va">times_xt</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">data</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">rxode2</span><span class="fu">::</span><span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxSolve</a></span><span class="op">(</span><span class="va">modrx</span>, <span class="va">p</span>, <span class="va">data</span>, atol<span class="op">=</span><span class="fl">1e-8</span>, rtol<span class="op">=</span><span class="fl">1e-8</span>,maxsteps<span class="op">=</span><span class="fl">5000</span>,</span>
<span>                 returnType<span class="op">=</span><span class="st">"data.frame"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span>  <span class="va">out</span><span class="op">$</span><span class="va">CP</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">times_xt</span>,<span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">f</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="common-model-elements">Common model elements<a class="anchor" aria-label="anchor" href="#common-model-elements"></a>
</h3>
<p>Other functions are used to define BSV and RUV.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sfg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">a</span>,<span class="va">bpop</span>,<span class="va">b</span>,<span class="va">bocc</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">parameters</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> </span>
<span>    KA<span class="op">=</span><span class="va">bpop</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    CL<span class="op">=</span><span class="va">bpop</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">b</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    V<span class="op">=</span><span class="va">bpop</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">b</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    DOSE<span class="op">=</span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    TAU<span class="op">=</span><span class="va">a</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="va">parameters</span> <span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">feps</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_switch</span>,<span class="va">xt</span>,<span class="va">parameters</span>,<span class="va">epsi</span>,<span class="va">poped.db</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">poped.db</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">ff_pointer</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">model_switch</span>,<span class="va">xt</span>,<span class="va">parameters</span>,<span class="va">poped.db</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">=</span> <span class="va">f</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">epsi</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">+</span><span class="va">epsi</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,poped.db<span class="op">=</span><span class="va">poped.db</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="create-poped-databases">Create PopED databases<a class="anchor" aria-label="anchor" href="#create-poped-databases"></a>
</h2>
<p>Next we define the model to use, the parameters of those models, the
intial design design and design space for any design calculation. Here
we create a number of databases that correspond to different model
implementations.</p>
<p>The initial design is a 2 group design, with doses of 20 mg or 40 mg
every 24 hours. Each group has the same sampling schedule, with 3
samples in the first day of the study and 2 on the 10th day of the
study.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poped_db_analytic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span></span>
<span>  ff_fun <span class="op">=</span><span class="va">ff_analytic</span>,</span>
<span>  fg_fun <span class="op">=</span><span class="va">sfg</span>,</span>
<span>  fError_fun<span class="op">=</span><span class="va">feps</span>,</span>
<span>  bpop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>KA<span class="op">=</span><span class="fl">0.25</span>,CL<span class="op">=</span><span class="fl">3.75</span>,V<span class="op">=</span><span class="fl">72.8</span><span class="op">)</span>, </span>
<span>  d<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>KA<span class="op">=</span><span class="fl">0.09</span>,CL<span class="op">=</span><span class="fl">0.25</span><span class="op">^</span><span class="fl">2</span>,V<span class="op">=</span><span class="fl">0.09</span><span class="op">)</span>, </span>
<span>  sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>prop<span class="op">=</span><span class="fl">0.04</span>,add<span class="op">=</span><span class="fl">0.0025</span><span class="op">)</span>,</span>
<span>  m<span class="op">=</span><span class="fl">2</span>,</span>
<span>  groupsize<span class="op">=</span><span class="fl">20</span>,</span>
<span>  xt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">240</span>,<span class="fl">245</span><span class="op">)</span>,</span>
<span>  minxt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">240</span>,<span class="fl">240</span><span class="op">)</span>,</span>
<span>  maxxt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">248</span>,<span class="fl">248</span><span class="op">)</span>,</span>
<span>  bUseGrouped_xt<span class="op">=</span><span class="fl">1</span>,</span>
<span>  a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>DOSE<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span><span class="op">)</span>,TAU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  maxa<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DOSE<span class="op">=</span><span class="fl">200</span>,TAU<span class="op">=</span><span class="fl">24</span><span class="op">)</span>,</span>
<span>  mina<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DOSE<span class="op">=</span><span class="fl">0</span>,TAU<span class="op">=</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">poped_db_ode_desolve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,ff_fun <span class="op">=</span> <span class="va">ff_ode_desolve</span><span class="op">)</span></span>
<span><span class="va">poped_db_ode_desolve_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,ff_fun <span class="op">=</span> <span class="va">ff_ode_desolve_c</span><span class="op">)</span></span>
<span><span class="va">poped_db_ode_desolve_rcpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,ff_fun <span class="op">=</span> <span class="va">ff_ode_desolve_rcpp</span><span class="op">)</span></span>
<span><span class="va">poped_db_ode_pkpdsim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,ff_fun <span class="op">=</span> <span class="va">ff_ode_pkpdsim</span><span class="op">)</span></span>
<span><span class="va">poped_db_ode_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,ff_fun <span class="op">=</span> <span class="va">ff_ode_mrg</span><span class="op">)</span></span>
<span><span class="va">poped_db_ode_rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.poped.database.html">create.poped.database</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,ff_fun <span class="op">=</span> <span class="va">ff_ode_rx</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-predictions">Model predictions<a class="anchor" aria-label="anchor" href="#model-predictions"></a>
</h2>
<p>So are there difference in the model predictions between the
different implementations?</p>
<p>Here is a visual representation of the model predictions for this
study design, based on the analytic solution:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_model_prediction.html">plot_model_prediction</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,model_num_points <span class="op">=</span> <span class="fl">500</span>,PI<span class="op">=</span><span class="cn">T</span>,separate.groups <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> </span></code></pre></div>
<p><img src="model_def_other_pkgs_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>We can compare the different predictions in this plot accross model
implementations. Here we see that the accuracy of the different methods
are within machine precision (or very small).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_analytic</span>,model_num_points <span class="op">=</span> <span class="fl">500</span>,include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_ode_desolve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve</span>,</span>
<span>                                     model_num_points <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                     include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pred_std</span>,<span class="va">pred_ode_desolve</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">pred_ode_desolve_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve_c</span>,</span>
<span>                                       model_num_points <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                       include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                       PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pred_std</span>,<span class="va">pred_ode_desolve_c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">pred_ode_desolve_rcpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve_rcpp</span>,</span>
<span>                                          model_num_points <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                          include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pred_std</span>,<span class="va">pred_ode_desolve_rcpp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">pred_ode_pkpdsim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_ode_pkpdsim</span>,</span>
<span>                                     model_num_points <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                     include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pred_std</span>,<span class="va">pred_ode_pkpdsim</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Component \"PI_l\": Mean relative difference: 1.998734e-08"</span></span>
<span></span>
<span><span class="va">pred_ode_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_ode_mrg</span>,</span>
<span>                                 model_num_points <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                 include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pred_std</span>,<span class="va">pred_ode_mrg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">pred_ode_rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_prediction.html">model_prediction</a></span><span class="op">(</span><span class="va">poped_db_ode_rx</span>,</span>
<span>                                 model_num_points <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                 include_sample_times <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 PI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pred_std</span>,<span class="va">pred_ode_rx</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluate-the-design">Evaluate the design<a class="anchor" aria-label="anchor" href="#evaluate-the-design"></a>
</h2>
<p>Here we compare the computation of the Fisher Information Matrix
(FIM). By comparing the <span class="math inline">\(ln(det(FIM))\)</span> (the lnD-objective function
value, or ofv).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">eval_std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_analytic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $ofv</span></span>
<span><span class="co">#&gt; [1] 48.98804</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fim</span></span>
<span><span class="co">#&gt;                   KA           CL           V       d_KA        d_CL        d_V</span></span>
<span><span class="co">#&gt; KA       1695.742314 -11.73537527 -6.75450789    0.00000     0.00000    0.00000</span></span>
<span><span class="co">#&gt; CL        -11.735375  29.99735715 -0.03288331    0.00000     0.00000    0.00000</span></span>
<span><span class="co">#&gt; V          -6.754508  -0.03288331  0.04213359    0.00000     0.00000    0.00000</span></span>
<span><span class="co">#&gt; d_KA        0.000000   0.00000000  0.00000000  147.24270     1.52226  192.23403</span></span>
<span><span class="co">#&gt; d_CL        0.000000   0.00000000  0.00000000    1.52226  2254.55188    1.21987</span></span>
<span><span class="co">#&gt; d_V         0.000000   0.00000000  0.00000000  192.23403     1.21987  634.42055</span></span>
<span><span class="co">#&gt; sig_prop    0.000000   0.00000000  0.00000000  148.86724   844.57325  387.53816</span></span>
<span><span class="co">#&gt; sig_add     0.000000   0.00000000  0.00000000 6555.68433 14391.88132 8669.58391</span></span>
<span><span class="co">#&gt;             sig_prop     sig_add</span></span>
<span><span class="co">#&gt; KA            0.0000       0.000</span></span>
<span><span class="co">#&gt; CL            0.0000       0.000</span></span>
<span><span class="co">#&gt; V             0.0000       0.000</span></span>
<span><span class="co">#&gt; d_KA        148.8672    6555.684</span></span>
<span><span class="co">#&gt; d_CL        844.5733   14391.881</span></span>
<span><span class="co">#&gt; d_V         387.5382    8669.584</span></span>
<span><span class="co">#&gt; sig_prop   7759.5374  110702.705</span></span>
<span><span class="co">#&gt; sig_add  110702.7045 4436323.946</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rse</span></span>
<span><span class="co">#&gt;         KA         CL          V       d_KA       d_CL        d_V   sig_prop </span></span>
<span><span class="co">#&gt;  16.285678   4.909749  11.209270 120.825798  34.448477  57.300408  36.104027 </span></span>
<span><span class="co">#&gt;    sig_add </span></span>
<span><span class="co">#&gt;  24.339781</span></span></code></pre></div>
<p>All the computations give very similar results:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval_ode_desolve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">eval_std</span><span class="op">$</span><span class="va">ofv</span>,<span class="va">eval_ode_desolve</span><span class="op">$</span><span class="va">ofv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Mean relative difference: 2.493043e-08"</span></span>
<span></span>
<span><span class="va">eval_ode_desolve_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve_c</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">eval_std</span><span class="op">$</span><span class="va">ofv</span>,<span class="va">eval_ode_desolve_c</span><span class="op">$</span><span class="va">ofv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Mean relative difference: 2.493043e-08"</span></span>
<span></span>
<span><span class="va">eval_ode_desolve_rccp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve_rcpp</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">eval_std</span><span class="op">$</span><span class="va">ofv</span>,<span class="va">eval_ode_desolve_rccp</span><span class="op">$</span><span class="va">ofv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Mean relative difference: 2.493043e-08"</span></span>
<span></span>
<span><span class="va">eval_ode_pkpdsim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_pkpdsim</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">eval_std</span><span class="op">$</span><span class="va">ofv</span>,<span class="va">eval_ode_pkpdsim</span><span class="op">$</span><span class="va">ofv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">eval_ode_mrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_mrg</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">eval_std</span><span class="op">$</span><span class="va">ofv</span>,<span class="va">eval_ode_mrg</span><span class="op">$</span><span class="va">ofv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Mean relative difference: 2.361612e-08"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="speed-of-fim-computation">Speed of FIM computation<a class="anchor" aria-label="anchor" href="#speed-of-fim-computation"></a>
</h2>
<p>We can compare the speed of the computations. Analytic solutions are
fast, as expected, in this case more than 20 times faster than any of
the ODE methods. mrgsolve is the fastest of the ODE solvers in this
example. Note that much of the speed difference between mrgsolve, RxODE
and PKPDsim has been found to be due to the overhead from pre- and
post-processing of the simulation from ODE systems. Other ways of
handling the pre- and post-processing may speed up these
computations.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_analytic</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve_c</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_desolve_rcpp</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_pkpdsim</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_mrg</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/evaluate_design.html">evaluate_design</a></span><span class="op">(</span><span class="va">poped_db_ode_rx</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_def_other_pkgs_img/model_def_other_pkgs_compare_speed.png"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="version-information">Version information<a class="anchor" aria-label="anchor" href="#version-information"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  C.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    C.UTF-8</span></span>
<span><span class="co">#&gt;  tz       UTC</span></span>
<span><span class="co">#&gt;  date     2023-11-16</span></span>
<span><span class="co">#&gt;  pandoc   2.19.2 @ /usr/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package      </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version   </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  backports       1.4.1      <span style="color: #555555;">2021-12-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  BH              1.81.0-1   <span style="color: #555555;">2023-01-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bslib           0.5.1      <span style="color: #555555;">2023-08-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cachem          1.0.8      <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  callr           3.7.3      <span style="color: #555555;">2022-11-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  checkmate       2.3.0      <span style="color: #555555;">2023-10-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cli             3.6.1      <span style="color: #555555;">2023-03-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  codetools       0.2-19     <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace      2.1-0      <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  crayon          1.5.2      <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  data.table      1.14.8     <span style="color: #555555;">2023-02-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  desc            1.4.2      <span style="color: #555555;">2022-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  deSolve       * 1.38       <span style="color: #555555;">2023-09-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  devtools        2.4.5      <span style="color: #555555;">2022-10-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  digest          0.6.33     <span style="color: #555555;">2023-07-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  dparser         1.3.1-10   <span style="color: #555555;">2023-03-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  dplyr           1.1.3      <span style="color: #555555;">2023-09-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ellipsis        0.3.2      <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  evaluate        0.23       <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fansi           1.0.5      <span style="color: #555555;">2023-10-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  farver          2.1.1      <span style="color: #555555;">2022-07-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fastmap         1.1.1      <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fs              1.6.3      <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  generics        0.1.3      <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ggplot2         3.4.4      <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  glue            1.6.2      <span style="color: #555555;">2022-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  gtable          0.3.4      <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  highr           0.10       <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmltools       0.5.7      <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmlwidgets     1.6.2      <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  httpuv          1.6.12     <span style="color: #555555;">2023-10-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  httr            1.4.7      <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jquerylib       0.1.4      <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jsonlite        1.8.7      <span style="color: #555555;">2023-06-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  kableExtra    * 1.3.4      <span style="color: #555555;">2021-02-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  knitr         * 1.45       <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  labeling        0.4.3      <span style="color: #555555;">2023-08-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  later           1.3.1      <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lattice         0.21-9     <span style="color: #555555;">2023-10-01</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  lifecycle       1.0.4      <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lotri           0.4.3      <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  magrittr        2.0.3      <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  memoise         2.0.1      <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  mime            0.12       <span style="color: #555555;">2021-09-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  miniUI          0.1.1.1    <span style="color: #555555;">2018-05-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  mrgsolve      * 1.1.1      <span style="color: #555555;">2023-08-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  munsell         0.5.0      <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  nlme            3.1-163    <span style="color: #555555;">2023-08-09</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  pillar          1.9.0      <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgbuild        1.4.2      <span style="color: #555555;">2023-06-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgconfig       2.0.3      <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgdown         2.0.7      <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgload         1.3.3      <span style="color: #555555;">2023-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  PKPDsim       * 1.3.0      <span style="color: #555555;">2023-03-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  PopED         * <span style="color: #BB00BB; font-weight: bold;">0.6.0.9002</span> <span style="color: #555555;">2023-11-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  PreciseSums     0.6        <span style="color: #555555;">2023-04-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  prettyunits     1.2.0      <span style="color: #555555;">2023-09-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  processx        3.8.2      <span style="color: #555555;">2023-06-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  profvis         0.3.8      <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  promises        1.2.1      <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ps              1.7.5      <span style="color: #555555;">2023-04-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  purrr           1.0.2      <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  qs              0.25.5     <span style="color: #555555;">2023-02-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R6              2.5.1      <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ragg            1.2.6      <span style="color: #555555;">2023-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  RApiSerialize   0.1.2      <span style="color: #555555;">2022-08-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  Rcpp          * 1.0.11     <span style="color: #555555;">2023-07-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  RcppParallel    5.1.7      <span style="color: #555555;">2023-02-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  remotes         2.4.2.1    <span style="color: #555555;">2023-07-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rlang           1.1.2      <span style="color: #555555;">2023-11-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rmarkdown       2.25       <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rprojroot       2.0.4      <span style="color: #555555;">2023-11-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rstudioapi      0.15.0     <span style="color: #555555;">2023-07-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rvest           1.0.3      <span style="color: #555555;">2022-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rxode2        * 2.0.14     <span style="color: #555555;">2023-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rxode2et        2.0.10     <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rxode2ll        2.0.11     <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rxode2parse     2.0.16     <span style="color: #555555;">2023-03-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rxode2random    2.0.11     <span style="color: #555555;">2023-03-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sass            0.4.7      <span style="color: #555555;">2023-07-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  scales          1.2.1      <span style="color: #555555;">2022-08-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sessioninfo     1.2.2      <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  shiny           1.7.5.1    <span style="color: #555555;">2023-10-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringfish      0.15.8     <span style="color: #555555;">2023-05-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringi         1.8.1      <span style="color: #555555;">2023-11-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringr         1.5.1      <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  svglite         2.1.2      <span style="color: #555555;">2023-10-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sys             3.4.2      <span style="color: #555555;">2023-05-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  systemfonts     1.0.5      <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  textshaping     0.3.7      <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tibble          3.2.1      <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tidyselect      1.2.0      <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  urlchecker      1.0.1      <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  usethis         2.2.2      <span style="color: #555555;">2023-07-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  utf8            1.2.4      <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  vctrs           0.6.4      <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  viridisLite     0.4.2      <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  webshot         0.5.5      <span style="color: #555555;">2023-06-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  withr           2.5.2      <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xfun            0.41       <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xml2            1.3.5      <span style="color: #555555;">2023-07-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xtable          1.8-4      <span style="color: #555555;">2019-04-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  yaml            2.3.7      <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /home/runner/work/_temp/Library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /opt/R/4.3.2/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [3] /opt/R/4.3.2/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#sessionInfo()</span></span></code></pre></div>
<!-- # References {-} -->
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://katalog.uu.se/profile/?id=N4-631" class="external-link">Andrew C. Hooker</a>, Marco Foracchia, <a href="https://katalog.uu.se/profile/?id=N9-467" class="external-link">Sebastian Ueckert</a>, <a href="https://scholar.google.se/citations?user=4CgHwr0AAAAJ&amp;hl=en" class="external-link">Joakim Nyberg</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
